/*
	Leon is WebGL-accelerated mpeg1-like video decoder

	Copyright (c) 2014-2022 Anton Bilan, Easy Bits Limited
	https://www.easy-bits.com
	JSV is a registered trademark of Easy Bits Limited

	Anyone can use and modify this software for free for non-commercial 
	use only provided they keep this license notice and say out loud word Leon.
	For commercial use obtaining a different license is required.

	This software is distributed WITHOUT ANY WARRANTY;
	even the implied warranty of MERCHANTABILITY or FITNESS FOR 
	A PARTICULAR PURPOSE.

*/

(function(){var Q={};if(void 0===A)var A=self;if(void 0===A.document){var va={log:function(){for(var m=[],v=0;v<arguments.length;v++)m.push(arguments[v]);A.postMessage({t:"func",n:"log",args:m})}};Q.worker_cap={xhr:void 0!==A.XMLHttpRequest,fet:void 0!==A.fetch&&void 0!==A.ReadableStream,sid:void 0!==A.ImageData};A.postMessage({t:"func",n:"wm",args:[Q.worker_cap]});A.jsv_is_ww=!0;var u={};A.navigator={appVersion:"",userAgent:""};u.URL="http://a.ca"}else if(u=A.document,va=A.console,A.jsv_is_ww=!1,
A.Worker){var wa=A.URL||A.webkitURL,la=u.getElementsByTagName("script");Q.worker_url=Q.worker_blob=!1;for(var oa=0;oa<la.length;oa++){if(-1!=la[oa].src.indexOf("jsv")){Q.worker_url=la[oa].src;var Da="self.importScripts('"+Q.worker_url+"');";break}Q.worker_url||(Da=la[la.length-1].textContent)}void 0!==wa&&(Q.worker_blob=wa.createObjectURL(new Blob([Da],{type:"text/javascript"})))}(function(){for(var m=0,v=["ms","moz","webkit","o"],w=0;w<v.length&&!A.requestAnimationFrame;++w)A.requestAnimationFrame=
A[v[w]+"RequestAnimationFrame"],A.cancelAnimationFrame=A[v[w]+"CancelAnimationFrame"]||A[v[w]+"CancelRequestAnimationFrame"];A.requestAnimationFrame||(A.requestAnimationFrame=function(I,G){var F=(new Date).getTime(),ba=Math.max(0,16-(F-m)),t=A.setTimeout(function(){I(F+ba)},ba);m=F+ba;return t});A.cancelAnimationFrame||(A.cancelAnimationFrame=function(I){clearTimeout(I)})})();(function(m){m.ez_dis=function(v){v.events={};v.on=v.addEventListener=function(w,I){this.events.hasOwnProperty(w)?this.events[w].push(I):
this.events[w]=[I];this.go("on",{event:w,count:this.events[w].length})};v.off=v.removeEventListener=function(w,I){if(this.events.hasOwnProperty(w)){var G=this;setTimeout(function(){var F=G.events[w].indexOf(I);-1!=F&&G.events[w].splice(F,1);G.go("off",{event:w,count:G.events[w].length})},0)}};v.go=v.dispatchEvent=function(w,I){if(this.events.hasOwnProperty(w)){var G={};G.detail=I;for(var F=this.events[w],ba=F.length,t=0;t<ba;t++)F[t].apply(null,[G])}}}})(A);(function(m){if(!m.jsv_is_ww){var v={};
m.ez_dis(v);v.on("on",function(G){"unlocked"==G.detail.event&&1==G.detail.count&&I()});m.ez_unlock=v;var w=m.location!=top.location&&u.referrer.split("/")[2]==u.URL.split("/")[2],I=function(){var G=["touchstart","touchend","mousedown","keydown"];unlockAudio=function(){G.forEach(function(F){u.documentElement.removeEventListener(F,unlockAudio);w&&m.parent.removeEventListener(F,unlockAudio)});v.dispatchEvent("unlocked",null)};G.forEach(function(F){u.documentElement.addEventListener(F,unlockAudio,!1);
w&&m.parent.addEventListener(F,unlockAudio,!1)})}}})(A);(function(m){function v(I){var G={focus:"visible",focusin:"visible",pageshow:"visible",blur:"hidden",focusout:"hidden",pagehide:"hidden"};I=I||m.event;I.type in G?m.ez_vi(G[I.type]):m.ez_vi(this[w]?"hidden":"visible")}m.ez_vi=function(){};var w="hidden";w in u?u.addEventListener("visibilitychange",v):(w="mozHidden")in u?u.addEventListener("mozvisibilitychange",v):(w="webkitHidden")in u?u.addEventListener("webkitvisibilitychange",v):(w="msHidden")in
u?u.addEventListener("msvisibilitychange",v):"onfocusin"in u?u.onfocusin=u.onfocusout=v:m.onpageshow=m.onpagehide=m.onfocus=m.onblur=v})(A);ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=function(m,v){var w=new Uint8Array(this);void 0===v&&(v=w.length);for(var I=new ArrayBuffer(v-m),G=new Uint8Array(I),F=0;F<G.length;F++)G[F]=w[F+m];return I});(function(m){function v(p,r){try{if(p.responseType=r,p.responseType===r)return G=r,F=!0}catch(J){}return!1}function w(){if(m.XMLHttpRequest)var p=
new m.XMLHttpRequest;else if(m.ActiveXObject)try{p=new ActiveXObject("Msxml2.XMLHTTP")}catch(r){p=new ActiveXObject("Microsoft.XMLHTTP")}return p}var I=0,G="arraybuffer",F=!1,ba=!1,t="fetch"in m&&"ReadableStream"in m?"f":"x";if("x"==t){var pa=w(),ma=["moz-chunked-arraybuffer","ms-stream"],f;for(f in ma)if(v(pa,ma[f]))break}ba="f"==t||F;var ha={bType:"bType",modeR:"mode",startR:"start",endR:"end",bpc:"bpc",urlR:"url",ondata:"ondata",onError:"onError",doneR:"done"},K={bType:"arraybuffer",mode:"range",
onError:function(p){throw Error(p);},bpc:1E5,start:0,end:""};m.ez_http=function(){return new na};var na=function(){this.stream=ba;this.requests=[]};na.prototype.cancel=function(p){for(var r=0;r<this.requests.length;r++)if(this.requests[r].id==p)return this.requests[r].loader.cancel(),!0;return!1};na.prototype.load=function(p){var r={},J={},D;for(D in ha)J[D]=ha[D]in p?p[ha[D]]:K[ha[D]];r.id=J.id=I++;r.loader="f"==t&&"arraybuffer"==J.bType&&"whole"!=J.modeR?new ja(J):new da(J);r.requestOptions=J;this.requests.push(r);
return r.id};var ja=function(p){this.totalR=0;this.startR=p.startR;this.endR=p.endR;this.firstChunk=this.isActive=!0;this.requestOptions=p;var r=new Headers;"range"!=p.modeR||0==p.startR&&""==p.endR||r.append("Range","bytes="+p.startR+"-"+p.endR);var J=this;fetch(p.urlR,{headers:r}).then(function(D){if(J.firstChunk&&!J.onFirstChunk(D))return!1;J.reader=D.body.getReader();return J.pump(J.reader)})};ja.prototype.onFirstChunk=function(p){this.firstChunk=!1;if(!p.ok)return this.requestOptions.onError({detail:{id:this.requestOptions.id,
message:this.requestOptions.urlR+" returned "+p.statusText}}),!1;var r=p.headers.get("Content-Range");if(r)this.totalR=r.split("/")[1];else if(this.endR=this.totalR=p.headers.get("Content-Length"),!this.totalR&&"range"==this.requestOptions.modeR)return this.requestOptions.onError({detail:{id:this.requestOptions.id,message:"No size for "+this.requestOptions.urlR}}),!1;if(""==this.endR||this.endR>=this.totalR)this.endR=this.totalR-1;return!0};ja.prototype.cancel=function(){this.isActive=!1;this.reader&&
this.reader.cancel()};ja.prototype.pump=function(p){if(this.isActive){var r=this;return p.read().then(function(J){if(J.done)r.requestOptions.doneR({id:r.requestOptions.id});else{var D=J.value.byteLength;r.requestOptions.ondata({url:r.requestOptions.urlR,total:r.totalR,end:r.startR+D-1,start:r.startR,id:r.requestOptions.id,data:J.value});r.startR+=D;return r.pump(p)}})}this.reader.cancel()};var da=function(p){this.firstChunk=!0;this.streaming=F&&"text"!=p.bType&&"whole"!=p.modeR;this.totalR=0;this.startR=
p.startR;this.endR=p.endR;this.isActive=!0;this.requestOptions=p;this.loadR()};da.prototype.onFirstChunk=function(p){this.firstChunk=!1;if(200>p.status||300<=p.status&&304!=p.status)return this.requestOptions.onError({detail:{id:this.requestOptions.id,message:this.requestOptions.urlR+" returned "+p.status+" "+p.getAllResponseHeaders().replace("\r\n"," ")}}),!1;var r=p.getResponseHeader("Content-Range");if(r)this.totalR=r.split("/")[1];else if(this.endR=this.totalR=p.getResponseHeader("Content-Length"),
!this.totalR&&"range"==this.requestOptions.modeR)return this.requestOptions.onError({detail:{id:this.requestOptions.id,message:"No size for "+this.requestOptions.urlR+" "+p.getAllResponseHeaders().replace("\r\n"," ")}}),!1;if(""==this.endR||this.endR>=this.totalR)this.endR=this.totalR-1;return!0};da.prototype.onload=function(p){if(this.isActive){if(this.firstChunk&&!this.onFirstChunk(p))return!1;if("text"==this.requestOptions.bType){easy_responseBody=p.responseText;var r=easy_responseBody.length}else this.streaming||
(easy_responseBody=p.response,r=easy_responseBody.byteLength);r&&!this.streaming&&(this.requestOptions.ondata({url:this.requestOptions.urlR,total:this.totalR,end:this.startR+r-1,start:this.startR,id:this.requestOptions.id,data:easy_responseBody}),this.startR+=r);this.loadR()}};da.prototype.loadR=function(){if(this.totalR&&this.startR>=this.totalR||""!=this.endR&&this.startR>=this.endR)this.requestOptions.doneR({id:this.requestOptions.id});else{if(this.streaming)var p=this.endR;else p=this.startR+
this.requestOptions.bpc-1,""!=this.endR&&p>this.endR&&(p=this.endR);this.ajax(p)}};da.prototype.cancel=function(){this.xhr&&this.xhr.abort();this.isActive=!1};da.prototype.ajax=function(p){var r=this,J="range"==this.requestOptions.modeR&&(0!=this.startR||""!=p),D=this.xhr=w(),X=this.requestOptions.urlR;J&&(X=-1==X.indexOf("?")?X+"?bytes="+this.startR+p:X+"&bytes="+this.startR+p);D.open("GET",X,!0);J&&D.setRequestHeader("Range","bytes="+this.startR+"-"+p);"text"==this.requestOptions.bType?-1!=navigator.appVersion.indexOf("MSIE")||
navigator.userAgent.match(/Trident.*rv 11\./)||D.overrideMimeType("text/plain; charset=x-user-defined"):D.responseType=G;p=function(xa){if(4==D.readyState)r.onload(D)};void 0!==D.onload?D.onload=p:D.onreadystatechange=p;this.streaming&&(D.onprogress=function(){if(r.firstChunk&&!r.onFirstChunk(D))return!1;r.requestOptions.ondata({url:r.requestOptions.urlR,total:r.totalR,end:r.startR+D.response.byteLength-1,start:r.startR,id:r.requestOptions.id,data:D.response});r.startR+=D.response.byteLength});D.send()}})(A);
(function(m){function v(a,c,d){var k=0;if(a.readyState<X)a.load(),a.addEventListener("loadedmetadata",function U(){a.removeEventListener("loadedmetadata",U);v(a,c,d)});else if(.1>Math.abs(a.currentTime-c))d(a);else{var n=function(){a.currentTime=c};a.addEventListener("seeked",function U(){if(.1<Math.abs(a.currentTime-c)&&(k++,3>k)){a.currentTime=c;return}a.removeEventListener("seeked",U);a.removeEventListener("stalled",n);d(a)});a.addEventListener("stalled",n);a.addEventListener("playing",function R(){a.removeEventListener("playing",
R);a.pause();a.currentTime=c});a.play()}}function w(a){pa||(pa=!0,u.addEventListener?u.addEventListener("DOMContentLoaded",function d(){u.removeEventListener("DOMContentLoaded",d,!1);a()},!1):u.attachEvent&&(u.attachEvent("onreadystatechange",function d(){"complete"===u.readyState&&(u.detachEvent("onreadystatechange",d),a())}),u.documentElement.doScroll&&m==m.top&&function k(){if(!ma){try{u.documentElement.doScroll("left")}catch(n){setTimeout(k,0);return}a()}}()))}function I(){var a=u.createElement;
u.createElement=function(c){return"video"==c?new m.video_jsv:a.call(u,c)};G()}function G(){var a=u.getElementsByTagName;u.getElementsByTagName=function(c){var d=a.call(u,c);d=[].slice.call(d);var k=[];"video"==c&&(c=a.call(u,"jsv"),k=[].slice.call(c));return d.concat(k)}}function F(a,c){var d=new m.video_jsv;d.style.width=a.offsetWidth+"px";d.style.height=a.offsetHeight+"px";for(var k="data-audio preload loop autoplay poster id class muted".split(" "),n=0;n<k.length;n++)a.hasAttribute(k[n])&&d.setAttribute(k[n],
a.getAttribute(k[n]));d.setAttribute("src",c);a.parentNode.replaceChild(d,a)}function ba(){ma=!0;for(var a=u.getElementsByTagName("video"),c=0;c<a.length;c++)if("VIDEO"==a[c].tagName)if("src"in a[c]&&/\.jsv$/.test(a[c].src))F(a[c],a[c].src);else for(var d=a[c].getElementsByTagName("source"),k=0;k<d.length;k++)/\.jsv$/.test(d[k].src)&&F(a[c],d[k].src)}var t=function(){m.ez_dis(this);this.log="";this._hls=this._live=this._ws=!1;this.NextMPEGStartCodeLimit=0;this._freeMemory=!1;this.freeBuffers()};t.prototype.freeBuffers=
function(){this.bufferLength=this.bufferLengthTotal=0;this._fullyLoaded=!1;this.endBuffer=this.startBuffer=this.currentBuffer=this.previousBuffer=NaN;this.TiRa=null;this.endRange=this.startRange=NaN;this.indexInBuffer=this.index=0};t.NOT_FOUND=-1;t.STALLING=-2;t.prototype.getBytes=function(a){this.byte_align();var c=this.indexInBuffer>>3;if(this.bufferLength-c>=a){var d=this.currentBuffer.data.subarray(c,c+a);this.advance(a<<3)}else{d=new Uint8Array(a);for(var k=0;k<a;){var n=a-k;if(n<this.bufferLength-
c){var z=c+n;copiedIt=n}else z=0,copiedIt=this.bufferLength-c;c||z?(z||(z=this.bufferLength),d.set(this.currentBuffer.data.subarray(c,z),k)):d.set(this.currentBuffer.data,k);k+=copiedIt;this.advance(copiedIt<<3);c=0}}return d};t.prototype.get16=function(){var a=this.getBits(16);32767<a&&(a-=65536);return a};t.prototype.byte_align=function(){var a;(a=this.index%8)&&this.advance(8-a)};t.prototype.read_sint=function(){var a=this.read_uint();0!=a&&1==this.getBits(1)&&(a=-a);return a};t.prototype.read_uint=
function(){for(var a=1;0==this.getBits(1);)a<<=1,1==this.getBits(1)&&(a+=1);return a-1};t.prototype.has=function(a){if(!this.currentBuffer)return this.onStalled(0),!1;var c=this.currentBuffer.data.byteLength-(this.indexInBuffer>>3);if(this._ws)return 8<c||this.currentBuffer.nextItem;for(var d=this.currentBuffer;d.nextItem&&d.end+1==d.nextItem.start;)c+=d.nextItem.data.byteLength,d=d.nextItem;if(c>=a||d.end+1==this.bufferLengthTotal)return c;this.onStalled(d.end+1);return!1};t.prototype.onStalled=
function(a){this.go("stalled",a)};t.prototype._onBufferAdvance=function(){this.go("bufferadvance",null);if(this._freeMemory){var a;(a=this.getNumberOfBuffersToBeRemoved())&&this.removeBuffersByNumber(a)}};t.prototype.removeBuffersByNumber=function(a){for(var c=this.startBuffer,d=0;d<a;d++)this.go("bufferremoved",c),c=c.nextItem;this.startBuffer=c;for(a=this.startRange;a.nextItem&&a.nextItem.start<=this.startBuffer.start;)a=a.nextItem;a.start=this.startBuffer.start;a.startDuration=this.startBuffer.startDuration;
this.startRange=a};t.prototype.getNumberOfBuffersToBeRemoved=function(){for(var a=[],c=0,d=this.startBuffer;d&&d.start<this.currentBuffer.start;)a.push(d.data.byteLength),d=d.nextItem;for(d=a.length-1;0<d&&c<this._bytesInBackwardBufferLimit;)c+=a[d],d--;return 0<d?d:0};t.prototype.getNextRangeToDownload=function(a,c,d,k){void 0===a&&(a=Math.floor(this.index>>3));if(this.bufferLengthTotal&&a>=this.bufferLengthTotal||this._fullyLoaded)return!1;if(this.endBuffer.end+1==a)c="";else{for(var n=c=this.startBuffer;c&&
c.start<a;)n=c,c=c.nextItem;if(n.start<=a&&n.end+1>=a){if(c&&n.end+1==c.start)for(;c&&n.end+1==c.start;)n=c,c=c.nextItem;a=n.end+1}c=c?c.start-1:""}d=(!this.currentBuffer||k?a:this.currentBuffer.end+1)+d-1;if(a>d)return!1;c>d&&(c=d);return this.bufferLengthTotal&&a>=this.bufferLengthTotal?!1:{start:a,end:c}};t.prototype.addBuffer=function(a){this.bufferLengthTotal=this._live?this.bufferLengthTotal+a.total:a.total;this.NextMPEGStartCodeLimit=this.bufferLengthTotal-4<<3;a.nextItem=null;if(this.startBuffer)if(this.endBuffer.end+
1<=a.start)this.endBuffer.nextItem=a,this.endBuffer=this.endBuffer.nextItem,this.endRange.end+1==a.start?(this.endRange.end=a.end,this.endRange.endDuration=a.endDuration):(a={start:a.start,end:a.end,nextItem:null,startDuration:a.startDuration,endDuration:a.endDuration},this.endRange.nextItem=a,this.endRange=this.endRange.nextItem);else if(this.startBuffer.start>=a.end+1)a.nextItem=this.startBuffer,this.startBuffer=a,this.startRange.start==a.end+1?(this.startRange.start=a.start,this.startRange.startDuration=
a.startDuration):(a={start:a.start,end:a.end,nextItem:null,startDuration:a.startDuration,endDuration:a.endDuration},a.nextItem=this.startRange,this.startRange=a);else{for(var c=this.startBuffer,d=this.startBuffer;c.end<a.start;)d=c,c=c.nextItem;a.nextItem=c;d.nextItem=a;for(d=c=this.startRange;c&&c.end<a.start;)d=c,c=c.nextItem;d.end+1==a.start&&c.start==a.end+1?(d.end=c.end,d.endDuration=c.endDuration,d.nextItem=c.nextItem):d.end+1==a.start?(d.end=a.end,d.endDuration=a.endDuration):c.start==a.end+
1?(c.start=a.start,c.startDuration=a.startDuration):(a={start:a.start,end:a.end,nextItem:null,startDuration:a.startDuration,endDuration:a.endDuration},a.nextItem=d.nextItem,d.nextItem=a)}else this.currentBuffer=this.endBuffer=this.startBuffer=a,this.bufferLength=this.startBuffer.data.byteLength,this.endRange=this.startRange={start:a.start,end:a.end,nextItem:null,startDuration:a.startDuration,endDuration:a.endDuration}};t.prototype.appendBuffer=function(a,c){var d=new Uint8Array(a.byteLength+c.byteLength);
d.set(new Uint8Array(a),0);d.set(new Uint8Array(c),a.byteLength);return d};t.prototype.getBits=function(a){var c=!1,d=this.indexInBuffer>>3,k=8-this.indexInBuffer%8;if(this.currentBuffer.data.byteLength<<3>=this.indexInBuffer+a)var n=this.currentBuffer.data;else if(this.currentBuffer.nextItem&&this.currentBuffer.end+1==this.currentBuffer.nextItem.start)c=!0,n=this.appendBuffer(this.currentBuffer.data.buffer,this.currentBuffer.nextItem.data.buffer),this.previousBuffer=this.currentBuffer,this.currentBuffer=
this.currentBuffer.nextItem,this.bufferLength=this.currentBuffer.data.byteLength,this._onBufferAdvance();else return this.onStalled(this.currentBuffer.end+1),t.STALLING;if(k>=a)return this.index+=a,this.indexInBuffer=c?this.index-(this.currentBuffer.start<<3):this.indexInBuffer+a,n[d]>>k-a&255>>8-a;var z=(this.indexInBuffer+a)%8,U=this.indexInBuffer+a-1>>3;k=n[d]&255>>8-k;for(d++;d<U;d++)k<<=8,k|=n[d];k=0<z?k<<z|n[d]>>8-z:k<<8|n[d];this.index+=a;this.indexInBuffer=c?this.index-(this.currentBuffer.start<<
3):this.indexInBuffer+a;return k};t.prototype.setUpNextBuffer=function(a,c){void 0===c&&(c=1);if(0<a)if(this.currentBuffer.nextItem&&this.currentBuffer.end+1==this.currentBuffer.nextItem.start)this.previousBuffer=this.currentBuffer,this.currentBuffer=this.currentBuffer.nextItem,this.bufferLength=this.currentBuffer.data.byteLength,this.indexInBuffer=a-1,this.index=(this.currentBuffer.start<<3)+this.indexInBuffer,c&&this._onBufferAdvance();else return c?(this.onStalled(this.currentBuffer.end+1),t.STALLING):
!1;else this.currentBuffer=this.previousBuffer,this.bufferLength=this.currentBuffer.data.byteLength,this.indexInBuffer=(this.currentBuffer.data.byteLength<<3)+a,this.index=(this.currentBuffer.end+1<<3)+a;return!0};t.prototype.advance=function(a){var c;return 0>=(c=this.indexInBuffer+a-((this.bufferLength<<3)-1))?(this.index+=a,this.indexInBuffer+=a):this.setUpNextBuffer(c)};t.prototype.rewind=function(a){return a<=this.indexInBuffer?(this.index-=a,this.indexInBuffer-=a):this.setUpNextBuffer(this.indexInBuffer-
a)};t.prototype.seek=function(a){var c=this.startBuffer,d=this.currentBuffer.start;if(this._hls){for(var k=0;k<this._hls.length;k++)if(this._hls[k].end>=a){if(this._hls[k].loaded)var n=a-this._hls[k].start;else return this.onStalled(this._hls[k].start),t.STALLING;break}for(;c.start!=this._hls[k].start;)c=c.nextItem;this.currentBuffer=c;this.bufferLength=this.currentBuffer.data.byteLength;this.indexInBuffer=n<<3;this.index=a<<3;d!=this._hls[k].start&&this._onBufferAdvance();return!0}do{if(c.end>=a&&
c.start<=a)return this.currentBuffer=c,this.bufferLength=this.currentBuffer.data.byteLength,this.indexInBuffer=a-this.currentBuffer.start<<3,this.index=a<<3,d!=this.currentBuffer.start&&this._onBufferAdvance(),!0;if(!c.nextItem||c.nextItem.start>a)return this.onStalled(a),t.STALLING;c=c.nextItem}while(1)};(function(a){a.jsv_dec=f=function(){a.ez_dis(this);this.rendered_frames_n=13;this.buffer=new c;this.bufferSize=3E5;this._meta=!1;this.customIntraQuantMatrix=new Uint8Array(64);this.customNonIntraQuantMatrix=
new Uint8Array(64);this.blockData=new Int32Array(64);this.sequenceStarted=!1;this._needMetaBasic=!0;this._keyMap=!1;this._lastCustomNonIntraMatrix=this._lastCustomIntraMatrix=0;this._bitRate=this.frameHeight=this.frameWidth=NaN;this.max=this.min=0};f.prototype.initGLBuffers=function(){var b=this.gl;this.glFrameBuffers={};b.activeTexture(b.TEXTURE7);for(var e=this.glFrameBuffers.rendered=Array(this.rendered_frames_n),g=0;g<this.rendered_frames_n;g++){e[g]=Array(this.n_comps);for(var l=0;l<this.n_comps;l++){var q=
1==l||2==l?1:0,B=this.codedWidth>>q;q=this.codedHeight>>q;var M=b.createFramebuffer(),S=this.createTexture(0,0,0);S.uid=g;b.texImage2D(b.TEXTURE_2D,0,b.RGBA,B/4,q,0,b.RGBA,b.UNSIGNED_BYTE,null);b.bindFramebuffer(b.FRAMEBUFFER,M);b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,S,0);e[g][l]={framebuffer:M,texture:S}}}e=this.glFrameBuffers.idct_1d=Array(this.n_comps);for(l=0;l<this.n_comps;l++)q=1==l||2==l?1:0,B=this.codedWidth>>q,q=this.codedHeight>>q,M=b.createFramebuffer(),S=
this.createTexture(0,0,0),S.uid=l,b.texImage2D(b.TEXTURE_2D,0,b.RGBA,B/2,q,0,b.RGBA,b.UNSIGNED_BYTE,null),b.bindFramebuffer(b.FRAMEBUFFER,M),b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,S,0),e[l]={framebuffer:M,texture:S}};f.prototype._initGL=function(b){this.gl=b;b.pixelStorei(b.UNPACK_ALIGNMENT,1);var e=b.getShaderPrecisionFormat(b.FRAGMENT_SHADER,b.HIGH_FLOAT);e||b.getShaderPrecisionFormat(b.FRAGMENT_SHADER,b.MEDIUM_FLOAT);e=b.getShaderPrecisionFormat(b.FRAGMENT_SHADER,
b.MEDIUM_INT);(this.integer=30<=e.rangeMax)?(ya="precision mediump float;\nprecision mediump int;\nuniform sampler2D _G;\nuniform sampler2D _f;\nuniform sampler2D _t;\nuniform sampler2D _b;\nuniform sampler2D _w;\nuniform sampler2D _v;\nuniform sampler2D _c;\nvarying vec2 _S;\nuniform int _ad;\nuniform int _ae;\nfloat _s(vec2 v) {\nfloat _ap = v.r*255. + v.g*255.*256.;\nif(_ap > 32767.)\n{\n_ap -= 65536.;\n}\nreturn _ap;\n}\nfloat _E(vec2 v) {\nfloat _ap;\nif( v.g < .5 ){\n_ap = v.r*255. + v.g*255.*256.;\n} else {\n_ap = (v.r*255.-256.) + (v.g*255. - 255.)*256.;\n}\nreturn _ap;\n}\nvec2 _B(float _aw){\nif(_aw < 0.){\n_aw += 65536.;\n}\nfloat _al = floor( _aw / 256. );\nfloat _ao = _aw - _al*256.;\nreturn vec2(_ao / 255., _al / 255. );\n}\nvoid main() {\nint b1, b3, b4, b6, b7, tmp1, tmp2, m0, x0, x1, x2, x3, x4, y3, y4, y5, y6, y7;\nvec2 _aj, _ah;\nfloat _A, _z;\nfloat _q;\nfloat _Q, _R;\nfloat _X[8];\nfloat _y = 0.4;\nfloat _m, _l;\nfloat _o, _k;\nfloat _e, _g;\nfloat _d, _h;\n_h = 1.0 / ( float(_ae) / 8. );\n_d = 1.0 / ( float(_ad) / 8. );\n_o = 1.0 / float(_ad);\n_k = 1.0 / float(_ae);\n_g = 2.* _k;\n_e = _o;\n_Q = \tfloor( floor( _S.x / _k ) / 8.0 );\n_R = \tfloor( floor( _S.y / _o ) / 8.0 );\n_A = mod( floor( _S.x / _g ), 4.0 );\n_z = mod( floor( _S.y / _e ), 8.0 );\n_m = _Q * 8. * _k + _z * _k + _k / 2.;\n_l = _R * 8. * _o + _o / 2.;\nfor( int i = 0; i < 8; i++ )\n{\n_X[i] = _E( texture2D( _G, vec2( _m , _l + _o * float(i) ) ).ra );\n}\nint _ag = texture2D( _w, vec2( ( _Q + .5 ) * _h, ( _R + .5 ) * _d ) ).r > 0. ? 1 : 0;\nfloat _O;\n_q = floor( texture2D( _t, vec2( _Q * _h, _R * _d ) )[0] * 255. + 0.5 );\nfloat dc = _X[0];\nfor( int i = 0; i < 8; i++ )\n{\nif( _X[i] == 0. )\n{\nfloat _U = texture2D( _v, vec2( 0.075 + _z * 0.125, 0.075 + float(i) * 0.125 ) ).r;\nfloat last_non_zero = texture2D( _c, vec2( _Q * _h, _R * _d ) ).r;\nif( _U  + 1.> last_non_zero ){\ncontinue;\n}\n}\n_X[i] *= 2.;\nfloat texelcoord_Q_x = 0.075 + _z * 0.125;\nfloat texelcoord_Q_y = 0.075 + float( i ) * 0.125;\nfloat _j = texelcoord_Q_y / 2.;\nif( _ag ==  0){\n_j += .5;\n}\n_O = floor( texture2D( _f, vec2( texelcoord_Q_x, _j ) )[0] * 255. + 0.5 );\nif (_ag == 0){\n_X[i] += _X[i] < 0. ? -1. : 1.;\n}\n_X[i] = floor(  _X[i] * _q * _O  / 16.0 );\nif( mod( _X[i], 2. ) == 0. )\n{\n_X[i] -= ( _X[i] > 0. ) ? 1. : -1.;\n}\n_X[i] = min( _X[i], 2047. );\n_X[i] = max( _X[i], -2048. );\n_X[i] *= floor( texture2D( _b, vec2( texelcoord_Q_x, texelcoord_Q_y ) )[0] * 255. + 0.5 );\n}\nif ( _z == 0.0 && _ag == 1 )\n{\n_X[0] = dc * 256.;\n}\nb1 = int(_X[4]);\nb3 = int(_X[2]) + int(_X[6]);\nb4 = int(_X[5]) - int(_X[3]);\ntmp1 = int(_X[1]) + int(_X[7]);\ntmp2 = int(_X[3]) + int(_X[5]);\nb6 = int(_X[1]) - int(_X[7]);\nb7 = tmp1 + tmp2;\nm0 =  int(_X[0]);\nx4 =  ((b6*473 - b4*196 + 128) / 256) - b7;\nx0 =  x4 - (((tmp1 - tmp2)*362 + 128) / 256);\nx1 =  m0 - b1;\nx2 =  (((int(_X[2]) - int(_X[6]))*362 + 128) / 256) - b3;\nx3 =  m0 + b1;\ny3 =  x1 + x2;\ny4 =  x3 + b3;\ny5 =  x1 - x2;\ny6 =  x3 - b3;\ny7 = -x0 - ((b4*473 + b6*196 + 128) / 256);\nif( _A == 0.0 )\n{\n_aj = _B( floor( float( b7 + y4 ) * _y ) );\n_ah = _B( floor( float( x4 + y3 ) * _y ) );\n}\nelse if( _A == 1.0 )\n{\n_aj = _B( floor( float ( y5 - x0 ) * _y ) );\n_ah = _B( floor( float ( y6 - y7 ) * _y ) );\n}\nelse if( _A == 2.0 )\n{\n_aj = _B( floor( float ( y6 + y7 ) * _y ) );\n_ah = _B( floor( float ( x0 + y5 ) * _y ) );\n}\nelse\n{\n_aj = _B( floor( float ( y3 - x4 ) * _y ) );\n_ah = _B( floor( float ( y4 - b7 ) * _y ) );\n}\ngl_FragColor = vec4(\n_aj.r,\n_aj.g,\n_ah.r,\n_ah.g\n);\n}",
za="precision mediump float;\nuniform sampler2D _G;\nuniform sampler2D _i;\nuniform sampler2D _w;\nuniform sampler2D _I;\nvarying vec2 _S;\nuniform int _ad;\nuniform int _ae;\nuniform float _ac;\nfloat _g, _e;\nfloat _F( float _ay ){\nreturn sign( _ay ) * floor( abs( _ay ) );\n}\nvec4 _p( float _ax, float _ay ) {\nvec4 _C;\nfloat _u = sign( _ax ) * floor( abs(_ax) / 4. );\nfloat _n = mod( abs(_ax), 4. );\nvec4 _Z = texture2D( _i, vec2( _S.x + _u * _g, 1.  - _S.y - _ay * _e ));\nvec4 _H;\nif( _n == 0. )\n{\n_C = _Z;\n}\nelse if( _ax > 0. )\n{\n_H = texture2D( _i, vec2( _S.x + ( _u + 1. ) * _g, 1. - _S.y - _ay * _e ));\nif( _n == 1. )\n{\n_C[0] = _Z[1];\n_C[1] = _Z[2];\n_C[2] = _Z[3];\n_C[3] = _H[0];\n}\nelse if( _n == 2. )\n{\n_C[0] = _Z[2];\n_C[1] = _Z[3];\n_C[2] = _H[0];\n_C[3] = _H[1];\n}\nelse\n{\n_C[0] = _Z[3];\n_C[1] = _H[0];\n_C[2] = _H[1];\n_C[3] = _H[2];\n}\n}\nelse\n{\n_H = texture2D( _i, vec2( _S.x + ( _u - 1. ) * _g, 1. - _S.y - _ay  * _e ));\nif( _n == 3. )\n{\n_C[0] = _H[1];\n_C[1] = _H[2];\n_C[2] = _H[3];\n_C[3] = _Z[0];\n}\nelse if( _n == 2. )\n{\n_C[0] = _H[2];\n_C[1] = _H[3];\n_C[2] = _Z[0];\n_C[3] = _Z[1];\n}\nelse\n{\n_C[0] = _H[3];\n_C[1] = _Z[0];\n_C[2] = _Z[1];\n_C[3] = _Z[2];\n}\n}\nreturn _C;\n}\nfloat _s(vec2 v) {\nfloat _ap = v.r*255. + v.g*255.*256.;\nif(_ap > 32767.)\n{\n_ap -= 65536.;\n}\nreturn _ap;\n}\nfloat _E(vec2 v) {\nfloat _ap;\nif( v.g < .5 ){\n_ap = v.r*255. + v.g*255.*256.;\n} else {\n_ap = (v.r*255.-256.) + (v.g*255. - 255.)*256.;\n}\nreturn _ap;\n}\nvec2 _B(float _aw){\nif(_aw < 0.){\n_aw += 65536.;\n}\nfloat _al = floor( _aw / 256. );\nfloat _ao = _aw - _al*256.;\nreturn vec2(_ao / 255., _al / 255. );\n}\nfloat _y = 0.4;\nvoid main() {\nint b1, b3, b4, b6, b7, tmp1, tmp2, m0, x0, x1, x2, x3, x4, y3, y4, y5, y6, y7;\nfloat _a;\nfloat _o, _k, _Q, _R, _A, _z, _m, _l;\nfloat _d, _h;\nint _X[8];\n_o = 1.0 / float(_ad);\n_k = 1.0 / float(_ae);\n_g = 2. * _k;\n_e = _o;\n_h = 1.0 / ( float(_ae) / 4. );\n_d = 1.0 / ( float(_ad) / 8. );\n_Q = \tfloor( floor( _S.x / _g ) / 2.0 );\n_R = \tfloor( floor( _S.y / _e ) / 8.0 );\n_A = mod( floor( _S.x / _g ), 2.0 );\n_a = 7. - mod( floor( _S.y / _e ), 8.0 );\n_z = mod( floor( _S.y / _e ), 8.0 );\n_m = _Q * 4. * _k + floor( _a / 2. ) * _k + _k * .5;\n_l = ( _R + .95 ) * 8. * _o;\nif( mod( _a, 2. ) == 0.0 )\n{\nfor( int i = 0; i < 8; i++ )\n{\nvec4 texel = texture2D( _G, vec2( _m , _l - _o * float(i) ) );\n_X[i] = int( _E( vec2( texel[0], texel[1] ) ) / _y );\n}\n}\nelse\n{\nfor( int i = 0; i < 8; i++ )\n{\nvec4 texel = texture2D( _G, vec2( _m , _l - _o * float(i) ) );\n_X[i] = int( _E( vec2( texel[2], texel[3] ) ) / _y );\n}\n}\nb1 = _X[4];\nb3 = _X[2] + _X[6];\nb4 = _X[5] - _X[3];\ntmp1 = _X[1] + _X[7];\ntmp2 = _X[3] + _X[5];\nb6 = _X[1] - _X[7];\nb7 = tmp1 + tmp2;\nm0 =  _X[0];\nx4 =  ((b6*473 - b4*196 + 128) / 256) - b7;\nx0 =  x4 - (((tmp1 - tmp2)*362 + 128) / 256);\nx1 =  m0 - b1;\nx2 =  (((_X[2] - _X[6])*362 + 128) / 256) - b3;\nx3 =  m0 + b1;\ny3 =  x1 + x2;\ny4 =  x3 + b3;\ny5 =  x1 - x2;\ny6 =  x3 - b3;\ny7 = -x0 - ((b4*473 + b6*196 + 128) / 256);\nif( _A == 0.0 )\n{\ngl_FragColor = vec4(\nfloat( ( b7 + y4 + 128 ) / 256 ) / 255.,\nfloat( ( x4 + y3 + 128 ) / 256 ) / 255.,\nfloat( ( y5 - x0 + 128 ) / 256 ) / 255.,\nfloat( ( y6 - y7 + 128 ) / 256 ) / 255.\n);\n}\nelse\n{\ngl_FragColor = vec4(\nfloat( ( y6 + y7 + 128 ) / 256 ) / 255.,\nfloat( ( x0 + y5 + 128 ) / 256 ) / 255.,\nfloat( ( y3 - x4 + 128 ) / 256 ) / 255.,\nfloat( ( y4 - b7 + 128 ) / 256 ) / 255.\n);\n}\n}",
Aa="precision mediump float;\nuniform sampler2D _G;\nuniform sampler2D _i;\nuniform sampler2D _w;\nuniform sampler2D _I;\nvarying vec2 _S;\nuniform int _ad;\nuniform int _ae;\nuniform float _ac;\nfloat _g, _e;\nfloat _F( float _ay ){\nreturn sign( _ay ) * floor( abs( _ay ) );\n}\nvec4 _p( float _ax, float _ay ) {\nvec4 _C;\nfloat _u = sign( _ax ) * floor( abs(_ax) / 4. );\nfloat _n = mod( abs(_ax), 4. );\nvec4 _Z = texture2D( _i, vec2( _S.x + _u * _g, 1.  - _S.y - _ay * _e ));\nvec4 _H;\nif( _n == 0. )\n{\n_C = _Z;\n}\nelse if( _ax > 0. )\n{\n_H = texture2D( _i, vec2( _S.x + ( _u + 1. ) * _g, 1. - _S.y - _ay * _e ));\nif( _n == 1. )\n{\n_C[0] = _Z[1];\n_C[1] = _Z[2];\n_C[2] = _Z[3];\n_C[3] = _H[0];\n}\nelse if( _n == 2. )\n{\n_C[0] = _Z[2];\n_C[1] = _Z[3];\n_C[2] = _H[0];\n_C[3] = _H[1];\n}\nelse\n{\n_C[0] = _Z[3];\n_C[1] = _H[0];\n_C[2] = _H[1];\n_C[3] = _H[2];\n}\n}\nelse\n{\n_H = texture2D( _i, vec2( _S.x + ( _u - 1. ) * _g, 1. - _S.y - _ay  * _e ));\nif( _n == 3. )\n{\n_C[0] = _H[1];\n_C[1] = _H[2];\n_C[2] = _H[3];\n_C[3] = _Z[0];\n}\nelse if( _n == 2. )\n{\n_C[0] = _H[2];\n_C[1] = _H[3];\n_C[2] = _Z[0];\n_C[3] = _Z[1];\n}\nelse\n{\n_C[0] = _H[3];\n_C[1] = _Z[0];\n_C[2] = _Z[1];\n_C[3] = _Z[2];\n}\n}\nreturn _C;\n}\nfloat _s(vec2 v) {\nfloat _ap = v.r*255. + v.g*255.*256.;\nif(_ap > 32767.)\n{\n_ap -= 65536.;\n}\nreturn _ap;\n}\nfloat _E(vec2 v) {\nfloat _ap;\nif( v.g < .5 ){\n_ap = v.r*255. + v.g*255.*256.;\n} else {\n_ap = (v.r*255.-256.) + (v.g*255. - 255.)*256.;\n}\nreturn _ap;\n}\nvec2 _B(float _aw){\nif(_aw < 0.){\n_aw += 65536.;\n}\nfloat _al = floor( _aw / 256. );\nfloat _ao = _aw - _al*256.;\nreturn vec2(_ao / 255., _al / 255. );\n}\nfloat _y = 0.4;\nvoid main() {\nint b1, b3, b4, b6, b7, tmp1, tmp2, m0, x0, x1, x2, x3, x4, y3, y4, y5, y6, y7;\nfloat _a;\nfloat _o, _k, _Q, _R, _A, _z, _m, _l;\nfloat _d, _h;\nint _X[8];\n_o = 1.0 / float(_ad);\n_k = 1.0 / float(_ae);\n_g = 2. * _k;\n_e = _o;\n_h = 1.0 / ( float(_ae) / 4. );\n_d = 1.0 / ( float(_ad) / 8. );\n_Q = \tfloor( floor( _S.x / _g ) / 2.0 );\n_R = \tfloor( floor( _S.y / _e ) / 8.0 );\n_A = mod( floor( _S.x / _g ), 2.0 );\n_a = 7. - mod( floor( _S.y / _e ), 8.0 );\n_z = mod( floor( _S.y / _e ), 8.0 );\n_m = _Q * 4. * _k + floor( _a / 2. ) * _k + _k * .5;\n_l = ( _R + .95 ) * 8. * _o;\nif( mod( _a, 2. ) == 0.0 )\n{\nfor( int i = 0; i < 8; i++ )\n{\nvec4 texel = texture2D( _G, vec2( _m , _l - _o * float(i) ) );\n_X[i] = int( _E( vec2( texel[0], texel[1] ) ) / _y );\n}\n}\nelse\n{\nfor( int i = 0; i < 8; i++ )\n{\nvec4 texel = texture2D( _G, vec2( _m , _l - _o * float(i) ) );\n_X[i] = int( _E( vec2( texel[2], texel[3] ) ) / _y );\n}\n}\nb1 = _X[4];\nb3 = _X[2] + _X[6];\nb4 = _X[5] - _X[3];\ntmp1 = _X[1] + _X[7];\ntmp2 = _X[3] + _X[5];\nb6 = _X[1] - _X[7];\nb7 = tmp1 + tmp2;\nm0 =  _X[0];\nx4 =  ((b6*473 - b4*196 + 128) / 256) - b7;\nx0 =  x4 - (((tmp1 - tmp2)*362 + 128) / 256);\nx1 =  m0 - b1;\nx2 =  (((_X[2] - _X[6])*362 + 128) / 256) - b3;\nx3 =  m0 + b1;\ny3 =  x1 + x2;\ny4 =  x3 + b3;\ny5 =  x1 - x2;\ny6 =  x3 - b3;\ny7 = -x0 - ((b4*473 + b6*196 + 128) / 256);\nvec4 _C;\nif( _Q < 4. || _R > 3. ){\n}\nif ( texture2D( _w, vec2( ( _Q + .5 ) * _h, 1. - ( _R + .5 ) * _d ) ).r > 0.5 )\n{\n_C = vec4(0.,0.,0.,0.);\n}\nelse\n{\nvec4 _ar = texture2D( _I, vec2( _S.x, 1. - _e * 0.25 - _S.y) );\nfloat _W = _E( _ar.rg );\nfloat _V = _E( _ar.ba );\nfloat _ax, _ay;\nbool odd_h, odd_v;\nif( _ac == 1.){\n_ax = floor( _W / 2. );\n_ay = floor( _V / 2. );\nodd_h = abs(_W - _ax * 2.) > 0.5;\nodd_v = abs(_V - _ay * 2.) > 0.5;\n}else{\n_ax = floor( _F( _W / 2.) / 2. );\n_ay = floor( _F( _V / 2.) / 2. );\nodd_h = ( mod( _F( _W / 2. ), 2. ) != 0.);\nodd_v = ( mod( _F( _V / 2. ), 2. ) != 0.);\n}\n_ay *= -1.;\n_C = _p( _ax, _ay );\nfloat _aa = 1.;\nvec4 _am = vec4( .001953125, .001953125, .001953125, .001953125 );\nif( odd_h ) {\n_C += _p( _ax + 1., _ay ) + _am;\n_aa *= 2.;\n}\nif ( odd_v ) {\n_C += _p( _ax, _ay - 1. ) + _am;\n_aa *= 2.;\n}\nif( odd_h && odd_v ) {\n_C += _p( _ax + 1., _ay - 1. );\n}\n_C /= _aa;\n}\nif( _A == 0.0 )\n{\ngl_FragColor = vec4(\n(float( ( b7 + y4 + 128 ) / 256 ) / 255.),\n(float( ( x4 + y3 + 128 ) / 256 ) / 255.),\n(float( ( y5 - x0 + 128 ) / 256 ) / 255.),\n(float( ( y6 - y7 + 128 ) / 256 ) / 255.)\n);\n}\nelse\n{\ngl_FragColor = vec4(\n(float( ( y6 + y7 + 128 ) / 256 ) / 255.),\n(float( ( x0 + y5 + 128 ) / 256 ) / 255.),\n(float( ( y3 - x4 + 128 ) / 256 ) / 255.),\n(float( ( y4 - b7 + 128 ) / 256 ) / 255.)\n);\n}\ngl_FragColor += _C;\n}"):
(ya="precision mediump float;\nprecision mediump int;\nuniform sampler2D _G;\nuniform sampler2D _f;\nuniform sampler2D _t;\nuniform sampler2D _b;\nuniform sampler2D _w;\nuniform sampler2D _v;\nuniform sampler2D _c;\nvarying vec2 _S;\nuniform int _ad;\nuniform int _ae;\nfloat _s(vec3 v) {\nfloat _ap = v.r*255. + v.g*255.*256.;\nif(_ap > 32767.)\n{\n_ap -= 65536.;\n}\nreturn _ap;\n}\nfloat _E(vec2 v) {\nfloat _ap;\nif( v.g < .5 ){\n_ap = v.r*255. + v.g*255.*256.;\n} else {\n_ap = (v.r*255.-256.) + (v.g*255. - 255.)*256.;\n}\nreturn _ap;\n}\nconst float _an = 1./255.;\nvec2 normalize_after_multi( vec2 v ){\nfloat v0abs = abs( v.r );\nif( v0abs > 1. ){\nfloat _ai = sign(v.r);\nfloat low = floor( v0abs / _an + .5 );\nfloat new_low = low - 256.*floor(low/256.);\nv.r = _ai * new_low * _an;\nv.g += _ai * ( low - new_low ) / 256. * _an;\n}\nreturn v;\n}\nvec2 _Y(vec2 v, float n){\nfloat d = _an * n;\nfloat v0 = floor( v[0] / d );\nfloat v1 = floor( v[1] * 256. / d ) / 256.;\nreturn vec2( v0*_an, v1*_an );\n}\nvec2 _D( vec2 _aq ){\nif( _aq.g < 0.5 ){\nreturn _aq;\n}else{\nreturn vec2( -(1.-( _aq.r - _an) ) + floor(1. - _aq.r)*(1.+_an), -(1.- (_aq.g-floor( 1.- _aq.r ) * _an ) ) );\n}\n}\nvec2 _x( vec2 _aq ){\nif(abs( _aq.r) > 1.){\n_aq = normalize_after_multi( _aq );\n}\nif( _aq.r < 0. || _aq.g < 0. ){\nfloat abs0 = abs( _aq.r );\nif( abs0 == 0. ){\nreturn vec2( 0., 1.+_aq.g + _an );\n} else {\nreturn vec2( 1.-abs0+_an, 1.+_aq.g );\n}\n}\nreturn _aq;\n}\nvec2 _ab( vec2 _aq[8], float x ){\nfloat _as, _at;\nvec2 _az;\n_az = vec2(0.,0.);\n_at = 3.1415926535897932384626433832795;\n_as = 1./sqrt(2.);\n_az += (_as/2.)*_aq[0];\n_as = 1.;\nfor( int u=1;u<8;u++){\n_az += (_as/2.)*_aq[u]*cos((2.*x+1.)*float(u)*_at/16.);\n}\nreturn _az;\n}\nvoid main() {\nint b1, b3, b4, b6, b7, tmp1, tmp2, m0, x0, x1, x2, x3, x4, y3, y4, y5, y6, y7;\nvec2 _aj, _ah;\nfloat _A, _z;\nfloat _q;\nfloat _Q, _R;\nvec2 _X[8];\nfloat _y = 0.4;\nfloat _m, _l;\nfloat _o, _k;\nfloat _e, _g;\nfloat _d, _h;\n_h = 1.0 / ( float(_ae) / 8. );\n_d = 1.0 / ( float(_ad) / 8. );\n_o = 1.0 / float(_ad);\n_k = 1.0 / float(_ae);\n_g = 2.* _k;\n_e = _o;\n_Q = \tfloor( floor( _S.x / _k ) / 8.0 );\n_R = \tfloor( floor( _S.y / _o ) / 8.0 );\n_A = mod( floor( _S.x / _g ), 4.0 );\n_z = mod( floor( _S.y / _e ), 8.0 );\n_m = _Q * 8. * _k + _z * _k + _k / 2.;\n_l = _R * 8. * _o + _o / 2.;\nfor( int i = 0; i < 8; i++ )\n{\n_X[i] = _D( texture2D( _G, vec2( _m , _l + _o * float(i) ) ).ra );\n}\nint _ag = texture2D( _w, vec2( ( _Q + .5 ) * _h, ( _R + .5 ) * _d ) ).r > 0. ? 1 : 0;\nfloat _O;\n_q = floor( texture2D( _t, vec2( _Q * _h, _R * _d ) )[0] * 255. + 0.5 );\nvec2 dc = _X[0];\nfor( int i = 0; i < 8; i++ )\n{\nif( _X[i] == vec2(0., 0.) )\n{\nfloat _U = texture2D( _v, vec2( 0.075 + _z * 0.125, 0.075 + float(i) * 0.125 ) ).r;\nfloat last_non_zero = texture2D( _c, vec2( _Q * _h, _R * _d ) ).r;\nif( _U  + 1.> last_non_zero ){\ncontinue;\n}\n}\n_X[i] *= 2.;\nfloat texelcoord_Q_x = 0.075 + _z * 0.125;\nfloat texelcoord_Q_y = 0.075 + float( i ) * 0.125;\nfloat _j = texelcoord_Q_y / 2.;\nif( _ag ==  0){\n_j += .5;\n}\n_O = floor( texture2D( _f, vec2( texelcoord_Q_x, _j ) )[0] * 255. + 0.5 );\nif (_ag == 0){\n_X[i].r += dot( _X[i], vec2( 1., 256.)) < 0. ? -_an : _an;\n}\n_X[i] =  _Y( _X[i] * _q * _O, 16.0 );\nif( mod( floor( _X[i].r / _an ), 2. ) == 0. ){\n_X[i].r -= dot( _X[i], vec2( 1., 256.)) < 0. ? _an : -_an;\n}\nif( dot( _X[i], vec2( 1., 256.)) > 8.027 ){\n_X[i] = vec2( 1., 7.*_an);\n}\nif( dot( _X[i], vec2( 1., 256.)) < -8.031 ){\n_X[i] = vec2( 0., -8.*_an);\n}\n}\nif ( _z == 0.0 && _ag == 1 )\n{\n_X[0] = dc * 8.;\n}\nif( _A == 0.0 )\n{\n_aj = _x( _ab( _X, 0.) * _y );\n_ah = _x( _ab( _X, 1.) * _y );\n}\nelse if( _A == 1.0 )\n{\n_aj = _x( _ab( _X, 2.) * _y );\n_ah = _x( _ab( _X, 3.) * _y );\n}\nelse if( _A == 2.0 )\n{\n_aj = _x( _ab( _X, 4.) * _y );\n_ah = _x( _ab( _X, 5.) * _y );\n}\nelse\n{\n_aj = _x( _ab( _X, 6.) * _y );\n_ah = _x( _ab( _X, 7.) * _y );\n}\ngl_FragColor = vec4(\n_aj.r,\n_aj.g,\n_ah.r,\n_ah.g\n);\n}",
za="precision mediump float;\nuniform sampler2D _G;\nuniform sampler2D _i;\nuniform sampler2D _w;\nuniform sampler2D _I;\nvarying vec2 _S;\nuniform int _ad;\nuniform int _ae;\nuniform float _ac;\nfloat _g, _e;\nfloat _F( float _ay ){\nreturn sign( _ay ) * floor( abs( _ay ) );\n}\nvec4 _p( float _ax, float _ay ) {\nvec4 _C;\nfloat _u = sign( _ax ) * floor( abs(_ax) / 4. );\nfloat _n = mod( abs(_ax), 4. );\nvec4 _Z = texture2D( _i, vec2( _S.x + _u * _g, 1.  - _S.y - _ay * _e ));\nvec4 _H;\nif( _n == 0. )\n{\n_C = _Z;\n}\nelse if( _ax > 0. )\n{\n_H = texture2D( _i, vec2( _S.x + ( _u + 1. ) * _g, 1. - _S.y - _ay * _e ));\nif( _n == 1. )\n{\n_C[0] = _Z[1];\n_C[1] = _Z[2];\n_C[2] = _Z[3];\n_C[3] = _H[0];\n}\nelse if( _n == 2. )\n{\n_C[0] = _Z[2];\n_C[1] = _Z[3];\n_C[2] = _H[0];\n_C[3] = _H[1];\n}\nelse\n{\n_C[0] = _Z[3];\n_C[1] = _H[0];\n_C[2] = _H[1];\n_C[3] = _H[2];\n}\n}\nelse\n{\n_H = texture2D( _i, vec2( _S.x + ( _u - 1. ) * _g, 1. - _S.y - _ay  * _e ));\nif( _n == 3. )\n{\n_C[0] = _H[1];\n_C[1] = _H[2];\n_C[2] = _H[3];\n_C[3] = _Z[0];\n}\nelse if( _n == 2. )\n{\n_C[0] = _H[2];\n_C[1] = _H[3];\n_C[2] = _Z[0];\n_C[3] = _Z[1];\n}\nelse\n{\n_C[0] = _H[3];\n_C[1] = _Z[0];\n_C[2] = _Z[1];\n_C[3] = _Z[2];\n}\n}\nreturn _C;\n}\nfloat _s(vec3 v) {\nfloat _ap = v.r*255. + v.g*255.*256.;\nif(_ap > 32767.)\n{\n_ap -= 65536.;\n}\nreturn _ap;\n}\nfloat _E(vec2 v) {\nfloat _ap;\nif( v.g < .5 ){\n_ap = v.r*255. + v.g*255.*256.;\n} else {\n_ap = (v.r*255.-256.) + (v.g*255. - 255.)*256.;\n}\nreturn _ap;\n}\nconst float _an = 1./255.;\nvec2 normalize_after_multi( vec2 v ){\nfloat v0abs = abs( v.r );\nif( v0abs > 1. ){\nfloat _ai = sign(v.r);\nfloat low = floor( v0abs / _an + .5 );\nfloat new_low = low - 256.*floor(low/256.);\nv.r = _ai * new_low * _an;\nv.g += _ai * ( low - new_low ) / 256. * _an;\n}\nreturn v;\n}\nvec2 _Y(vec2 v, float n){\nfloat d = _an * n;\nfloat v0 = floor( v[0] / d );\nfloat v1 = floor( v[1] * 256. / d ) / 256.;\nreturn vec2( v0*_an, v1*_an );\n}\nvec2 _D( vec2 _aq ){\nif( _aq.g < 0.5 ){\nreturn _aq;\n}else{\nreturn vec2( -(1.-( _aq.r - _an) ) + floor(1. - _aq.r)*(1.+_an), -(1.- (_aq.g-floor( 1.- _aq.r ) * _an ) ) );\n}\n}\nvec2 _x( vec2 _aq ){\nif(abs( _aq.r) > 1.){\n_aq = normalize_after_multi( _aq );\n}\nif( _aq.r < 0. || _aq.g < 0. ){\nfloat abs0 = abs( _aq.r );\nif( abs0 == 0. ){\nreturn vec2( 0., 1.+_aq.g + _an );\n} else {\nreturn vec2( 1.-abs0+_an, 1.+_aq.g );\n}\n}\nreturn _aq;\n}\nvec2 _ab( vec2 _aq[8], float x ){\nfloat _as, _at;\nvec2 _az;\n_az = vec2(0.,0.);\n_at = 3.1415926535897932384626433832795;\n_as = 1./sqrt(2.);\n_az += (_as/2.)*_aq[0];\n_as = 1.;\nfor( int u=1;u<8;u++){\n_az += (_as/2.)*_aq[u]*cos((2.*x+1.)*float(u)*_at/16.);\n}\nreturn _az;\n}\nfloat _y = 0.4;\nvoid main() {\nint b1, b3, b4, b6, b7, tmp1, tmp2, m0, x0, x1, x2, x3, x4, y3, y4, y5, y6, y7;\nfloat _a;\nfloat _o, _k, _Q, _R, _A, _z, _m, _l;\nfloat _d, _h;\nvec2 _X[8];\n_o = 1.0 / float(_ad);\n_k = 1.0 / float(_ae);\n_g = 2. * _k;\n_e = _o;\n_h = 1.0 / ( float(_ae) / 4. );\n_d = 1.0 / ( float(_ad) / 8. );\n_Q = \tfloor( floor( _S.x / _g ) / 2.0 );\n_R = \tfloor( floor( _S.y / _e ) / 8.0 );\n_A = mod( floor( _S.x / _g ), 2.0 );\n_a = 7. - mod( floor( _S.y / _e ), 8.0 );\n_z = mod( floor( _S.y / _e ), 8.0 );\n_m = _Q * 4. * _k + floor( _a / 2. ) * _k + _k * .5;\n_l = ( _R + .95 ) * 8. * _o;\nif( mod( _a, 2. ) == 0.0 )\n{\nfor( int i = 0; i < 8; i++ )\n{\nvec4 texel = texture2D( _G, vec2( _m , _l - _o * float(i) ) );\n_X[i] = _D( vec2( texel[0], texel[1] ) ) / _y;\n}\n}\nelse\n{\nfor( int i = 0; i < 8; i++ )\n{\nvec4 texel = texture2D( _G, vec2( _m , _l - _o * float(i) ) );\n_X[i] = _D( vec2( texel[2], texel[3] ) ) / _y;\n}\n}\nif( _A == 0.0 )\n{\ngl_FragColor = vec4(\ndot( _ab( _X, 0.), vec2(1.,256.) ),\ndot( _ab( _X, 1.), vec2(1.,256.) ),\ndot( _ab( _X, 2.), vec2(1.,256.) ),\ndot( _ab( _X, 3.), vec2(1.,256.) )\n);\n}\nelse\n{\ngl_FragColor = vec4(\ndot( _ab( _X, 4.), vec2(1.,256.) ),\ndot( _ab( _X, 5.), vec2(1.,256.) ),\ndot( _ab( _X, 6.), vec2(1.,256.) ),\ndot( _ab( _X, 7.), vec2(1.,256.) )\n);\n}\n}",
Aa="precision mediump float;\nuniform sampler2D _G;\nuniform sampler2D _i;\nuniform sampler2D _w;\nuniform sampler2D _I;\nvarying vec2 _S;\nuniform int _ad;\nuniform int _ae;\nuniform float _ac;\nfloat _g, _e;\nfloat _F( float _ay ){\nreturn sign( _ay ) * floor( abs( _ay ) );\n}\nvec4 _p( float _ax, float _ay ) {\nvec4 _C;\nfloat _u = sign( _ax ) * floor( abs(_ax) / 4. );\nfloat _n = mod( abs(_ax), 4. );\nvec4 _Z = texture2D( _i, vec2( _S.x + _u * _g, 1.  - _S.y - _ay * _e ));\nvec4 _H;\nif( _n == 0. )\n{\n_C = _Z;\n}\nelse if( _ax > 0. )\n{\n_H = texture2D( _i, vec2( _S.x + ( _u + 1. ) * _g, 1. - _S.y - _ay * _e ));\nif( _n == 1. )\n{\n_C[0] = _Z[1];\n_C[1] = _Z[2];\n_C[2] = _Z[3];\n_C[3] = _H[0];\n}\nelse if( _n == 2. )\n{\n_C[0] = _Z[2];\n_C[1] = _Z[3];\n_C[2] = _H[0];\n_C[3] = _H[1];\n}\nelse\n{\n_C[0] = _Z[3];\n_C[1] = _H[0];\n_C[2] = _H[1];\n_C[3] = _H[2];\n}\n}\nelse\n{\n_H = texture2D( _i, vec2( _S.x + ( _u - 1. ) * _g, 1. - _S.y - _ay  * _e ));\nif( _n == 3. )\n{\n_C[0] = _H[1];\n_C[1] = _H[2];\n_C[2] = _H[3];\n_C[3] = _Z[0];\n}\nelse if( _n == 2. )\n{\n_C[0] = _H[2];\n_C[1] = _H[3];\n_C[2] = _Z[0];\n_C[3] = _Z[1];\n}\nelse\n{\n_C[0] = _H[3];\n_C[1] = _Z[0];\n_C[2] = _Z[1];\n_C[3] = _Z[2];\n}\n}\nreturn _C;\n}\nfloat _s(vec3 v) {\nfloat _ap = v.r*255. + v.g*255.*256.;\nif(_ap > 32767.)\n{\n_ap -= 65536.;\n}\nreturn _ap;\n}\nfloat _E(vec2 v) {\nfloat _ap;\nif( v.g < .5 ){\n_ap = v.r*255. + v.g*255.*256.;\n} else {\n_ap = (v.r*255.-256.) + (v.g*255. - 255.)*256.;\n}\nreturn _ap;\n}\nconst float _an = 1./255.;\nvec2 normalize_after_multi( vec2 v ){\nfloat v0abs = abs( v.r );\nif( v0abs > 1. ){\nfloat _ai = sign(v.r);\nfloat low = floor( v0abs / _an + .5 );\nfloat new_low = low - 256.*floor(low/256.);\nv.r = _ai * new_low * _an;\nv.g += _ai * ( low - new_low ) / 256. * _an;\n}\nreturn v;\n}\nvec2 _Y(vec2 v, float n){\nfloat d = _an * n;\nfloat v0 = floor( v[0] / d );\nfloat v1 = floor( v[1] * 256. / d ) / 256.;\nreturn vec2( v0*_an, v1*_an );\n}\nvec2 _D( vec2 _aq ){\nif( _aq.g < 0.5 ){\nreturn _aq;\n}else{\nreturn vec2( -(1.-( _aq.r - _an) ) + floor(1. - _aq.r)*(1.+_an), -(1.- (_aq.g-floor( 1.- _aq.r ) * _an ) ) );\n}\n}\nvec2 _x( vec2 _aq ){\nif(abs( _aq.r) > 1.){\n_aq = normalize_after_multi( _aq );\n}\nif( _aq.r < 0. || _aq.g < 0. ){\nfloat abs0 = abs( _aq.r );\nif( abs0 == 0. ){\nreturn vec2( 0., 1.+_aq.g + _an );\n} else {\nreturn vec2( 1.-abs0+_an, 1.+_aq.g );\n}\n}\nreturn _aq;\n}\nvec2 _ab( vec2 _aq[8], float x ){\nfloat _as, _at;\nvec2 _az;\n_az = vec2(0.,0.);\n_at = 3.1415926535897932384626433832795;\n_as = 1./sqrt(2.);\n_az += (_as/2.)*_aq[0];\n_as = 1.;\nfor( int u=1;u<8;u++){\n_az += (_as/2.)*_aq[u]*cos((2.*x+1.)*float(u)*_at/16.);\n}\nreturn _az;\n}\nfloat _y = 0.4;\nvoid main() {\nint b1, b3, b4, b6, b7, tmp1, tmp2, m0, x0, x1, x2, x3, x4, y3, y4, y5, y6, y7;\nfloat _a;\nfloat _o, _k, _Q, _R, _A, _z, _m, _l;\nfloat _d, _h;\nvec2 _X[8];\n_o = 1.0 / float(_ad);\n_k = 1.0 / float(_ae);\n_g = 2. * _k;\n_e = _o;\n_h = 1.0 / ( float(_ae) / 4. );\n_d = 1.0 / ( float(_ad) / 8. );\n_Q = \tfloor( floor( _S.x / _g ) / 2.0 );\n_R = \tfloor( floor( _S.y / _e ) / 8.0 );\n_A = mod( floor( _S.x / _g ), 2.0 );\n_a = 7. - mod( floor( _S.y / _e ), 8.0 );\n_z = mod( floor( _S.y / _e ), 8.0 );\n_m = _Q * 4. * _k + floor( _a / 2. ) * _k + _k * .5;\n_l = ( _R + .95 ) * 8. * _o;\nif( mod( _a, 2. ) == 0.0 )\n{\nfor( int i = 0; i < 8; i++ )\n{\nvec4 texel = texture2D( _G, vec2( _m , _l - _o * float(i) ) );\n_X[i] = _D( vec2( texel[0], texel[1] ) ) / _y;\n}\n}\nelse\n{\nfor( int i = 0; i < 8; i++ )\n{\nvec4 texel = texture2D( _G, vec2( _m , _l - _o * float(i) ) );\n_X[i] = _D( vec2( texel[2], texel[3] ) ) / _y;\n}\n}\nvec4 _C;\nif( _Q < 4. || _R > 3. ){\n}\nif ( texture2D( _w, vec2( ( _Q + .5 ) * _h, 1. - ( _R + .5 ) * _d ) ).r > 0.5 )\n{\n_C = vec4(0.,0.,0.,0.);\n}\nelse\n{\nvec4 _ar = texture2D( _I, vec2( _S.x, 1. - _e * 0.25 - _S.y) );\nfloat _W = _E( _ar.rg );\nfloat _V = _E( _ar.ba );\nfloat _ax, _ay;\nbool odd_h, odd_v;\nif( _ac == 1.){\n_ax = floor( _W / 2. );\n_ay = floor( _V / 2. );\nodd_h = abs(_W - _ax * 2.) > 0.5;\nodd_v = abs(_V - _ay * 2.) > 0.5;\n}else{\n_ax = floor( _F( _W / 2.) / 2. );\n_ay = floor( _F( _V / 2.) / 2. );\nodd_h = ( mod( _F( _W / 2. ), 2. ) != 0.);\nodd_v = ( mod( _F( _V / 2. ), 2. ) != 0.);\n}\n_ay *= -1.;\n_C = _p( _ax, _ay );\nfloat _aa = 1.;\nvec4 _am = vec4( .001953125, .001953125, .001953125, .001953125 );\nif( odd_h ) {\n_C += _p( _ax + 1., _ay ) + _am;\n_aa *= 2.;\n}\nif ( odd_v ) {\n_C += _p( _ax, _ay - 1. ) + _am;\n_aa *= 2.;\n}\nif( odd_h && odd_v ) {\n_C += _p( _ax + 1., _ay - 1. );\n}\n_C /= _aa;\n}\nif( _A == 0.0 )\n{\ngl_FragColor = vec4(\ndot( _ab( _X, 0.), vec2(1.,256.) ),\ndot( _ab( _X, 1.), vec2(1.,256.) ),\ndot( _ab( _X, 2.), vec2(1.,256.) ),\ndot( _ab( _X, 3.), vec2(1.,256.) )\n);\n}\nelse\n{\ngl_FragColor = vec4(\ndot( _ab( _X, 4.), vec2(1.,256.) ),\ndot( _ab( _X, 5.), vec2(1.,256.) ),\ndot( _ab( _X, 6.), vec2(1.,256.) ),\ndot( _ab( _X, 7.), vec2(1.,256.) )\n);\n}\ngl_FragColor += _C;\n}");
this.programs={};this.programs.idct_columns={uniforms:{}};e=this.programs.idct_columns.program=b.createProgram();b.attachShader(e,this.compileShader(b.VERTEX_SHADER,qa));b.attachShader(e,this.compileShader(b.FRAGMENT_SHADER,ya));b.linkProgram(e);if(!b.getProgramParameter(e,b.LINK_STATUS))throw Error(b.getProgramInfoLog(e));this.gl.useProgram(e);var g=b.getAttribLocation(e,"vertex");b.enableVertexAttribArray(g);b.vertexAttribPointer(g,2,b.FLOAT,!1,0,0);g=this.programs.idct_columns.uniforms;g.width=
b.getUniformLocation(e,"_ae");g.height=b.getUniformLocation(e,"_ad");this.TextureDCT=this.createTexture(0,"_G",e);this.QUANT_MATRIX=new Uint8Array(128);this.QUANT_MATRIX.set(z);this.QUANT_MATRIX.set(U,64);this.TextureDCTQuant=this.createTexture(1,"_f",e);b.texImage2D(b.TEXTURE_2D,0,b.LUMINANCE,8,16,0,b.LUMINANCE,b.UNSIGNED_BYTE,this.QUANT_MATRIX);this.TextureDCTQuantScale=this.createTexture(2,"_t",e);this.TextureDCTPremultiple=this.createTexture(3,"_b",e);b.texImage2D(b.TEXTURE_2D,0,b.LUMINANCE,8,
8,0,b.LUMINANCE,b.UNSIGNED_BYTE,R);this.TextureIntre=this.createTexture(4,"_w",e);this.TextureZigZag=this.createTexture(5,"_v",e);b.texImage2D(b.TEXTURE_2D,0,b.LUMINANCE,8,8,0,b.LUMINANCE,b.UNSIGNED_BYTE,n);this.TextureLastNonZero=this.createTexture(6,"_c",e);this.programs.idct_rows_intra={uniforms:{}};e=this.programs.idct_rows_intra.program=b.createProgram();b.attachShader(e,this.compileShader(b.VERTEX_SHADER,qa));b.attachShader(e,this.compileShader(b.FRAGMENT_SHADER,za));b.linkProgram(e);if(!b.getProgramParameter(e,
b.LINK_STATUS))throw Error(b.getProgramInfoLog(e));g=b.getAttribLocation(e,"vertex");b.enableVertexAttribArray(g);b.vertexAttribPointer(g,2,b.FLOAT,!1,0,0);this.gl.useProgram(e);g=this.programs.idct_rows_intra.uniforms;g.width=b.getUniformLocation(e,"_ae");g.height=b.getUniformLocation(e,"_ad");this.programs.idct_rows_inter={uniforms:{}};e=this.programs.idct_rows_inter.program=b.createProgram();b.attachShader(e,this.compileShader(b.VERTEX_SHADER,qa));b.attachShader(e,this.compileShader(b.FRAGMENT_SHADER,
Aa));b.linkProgram(e);if(!b.getProgramParameter(e,b.LINK_STATUS))throw Error(b.getProgramInfoLog(e));this.gl.useProgram(e);g=this.programs.idct_rows_inter.uniforms;g.width=b.getUniformLocation(e,"_ae");g.height=b.getUniformLocation(e,"_ad");g.mv_coef=b.getUniformLocation(e,"_ac");b.uniform1i(b.getUniformLocation(e,"_G"),0);b.uniform1i(b.getUniformLocation(e,"_i"),1);b.uniform1i(b.getUniformLocation(e,"_w"),2);this.TextureMV=this.createTexture(3,"_I",e);g=b.getAttribLocation(e,"vertex");b.enableVertexAttribArray(g);
b.vertexAttribPointer(g,2,b.FLOAT,!1,0,0)};f.prototype.createTexture=function(b,e,g){var l=this.gl,q=l.createTexture();l.bindTexture(l.TEXTURE_2D,q);l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.NEAREST);l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.NEAREST);l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE);l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE);e&&l.uniform1i(l.getUniformLocation(g,e),b);return q};f.prototype.compileShader=function(b,e){var g=this.gl,
l=g.createShader(b);g.shaderSource(l,e);g.compileShader(l);if(!g.getShaderParameter(l,g.COMPILE_STATUS))throw Error(g.getShaderInfoLog(l));return l};f.prototype._initMeta=function(){if(this.buffer._live)return!0;if(this._decoding)return!1;this._decoding=!0;if(this._needMetaBasic){this._needMetaBasic=!1;this.buffer.advance(16);this._meta={};this._meta.w=this.buffer.getBits(16);this._meta.h=this.buffer.getBits(16);this._meta.d=this.buffer.getBits(16)/100;this._meta.d||(this._meta.a=this.yuva=this.buffer.getBits(1),
this._meta.d=this.buffer.getBits(23)/100,this.n_comps=this.yuva?4:3);this.go("meta",this._meta);if(this.buffer.getBits(32)==ra)return this.countGOP=this.buffer.getBits(32),this._initGop();this.buffer.rewind(32)}else return this._initGop();this._decoding=!1;return!0};f.prototype._initGop=function(){var b=this.countGOP,e=this.buffer.index>>3;bytesleft=8*b;for(var g=this.buffer.currentBuffer,l=new ArrayBuffer(0);bytesleft;)if(g.data.buffer.byteLength>=e+bytesleft){this.buffer.appendBuffer(l,g.data.buffer.slice(e,
e+bytesleft));break}else if(l=this.buffer.appendBuffer(l,g.data.buffer),bytesleft-=g.data.buffer.byteLength,g.nextItem)g=g.nextItem;else return this._decoding=!1;this._keyMap={count:b,buffer:new Uint8Array(this.buffer.currentBuffer.data.buffer.slice(e,e+8*b))};this.buffer.advance(8*b<<3);this._decoding=!1;return!0};f.prototype._getTimeByKeyNumber=function(b){var e=this._keyMap.buffer;b=8*b+4;return 60*(60*((e[b]&124)>>2)+(((e[b]&3)<<4)+((e[b+1]&240)>>4)))+(((e[b+1]&7)<<3)+((e[b+2]&224)>>5))+(((e[b+
2]&31)<<1)+((e[b+3]&128)>>7)+1)/this.pictureRate};f.prototype._getByteFromKeyMap=function(b){var e=Math.floor(this._keyMap.count*b/this._meta.d),g=this._getTimeByKeyNumber(e);if(g>b)for(;g>b&&0<e;)e--,g=this._getTimeByKeyNumber(e);else if(g<b){for(;g<=b&&e<this._keyMap.count;)e++,g=this._getTimeByKeyNumber(e);g>b&&e--}e*=8;b=this._keyMap.buffer;return(b[e]<<24)+(b[e+1]<<16)+(b[e+2]<<8)+b[e+3]};f.prototype.initBuffers=function(){this.intraQuantMatrix=z;this.nonIntraQuantMatrix=U;this.mbWidth=this.frameWidth+
15>>4;this.mbHeight=this.frameHeight+15>>4;this.mbSize=this.mbWidth*this.mbHeight;this.codedWidth=this.mbWidth<<4;this.codedHeight=this.mbHeight<<4;this.codedSize=this.codedWidth*this.codedHeight;this.halfWidth=this.mbWidth<<3;this.halfHeight=this.mbHeight<<3;this.quarterSize=this.codedSize>>2;if(!this.sequenceStarted){this.sequenceStarted=!0;this.initGLBuffers();var b=a.Uint8Array;this.last_non_zero=[new Uint8Array(4*this.mbSize),new Uint8Array(this.mbSize),new Uint8Array(this.mbSize)];this.macroblockQuant=
new Uint8Array(this.mbSize);this.macroblockIsIntra=new Uint8Array(this.mbSize);this.currentYDCT16=new Int16Array(this.codedSize);this.currentYDCTU8=new Uint8Array(this.currentYDCT16.buffer);this.currentY=new b(this.codedSize);this.currentY32=new Uint32Array(this.currentY.buffer);this.currentCrDCT16=new Int16Array(this.codedSize>>2);this.currentCrDCTU8=new Uint8Array(this.currentCrDCT16.buffer);this.currentCr=new b(this.codedSize>>2);this.currentCr32=new Uint32Array(this.currentCr.buffer);this.currentCbDCT16=
new Int16Array(this.codedSize>>2);this.currentCbDCTU8=new Uint8Array(this.currentCbDCT16.buffer);this.currentCb=new b(this.codedSize>>2);this.currentCb32=new Uint32Array(this.currentCb.buffer);this.forwardY=new b(this.codedSize);this.forwardY32=new Uint32Array(this.forwardY.buffer);this.forwardCr=new b(this.codedSize>>2);this.forwardCr32=new Uint32Array(this.forwardCr.buffer);this.forwardCb=new b(this.codedSize>>2);this.forwardCb32=new Uint32Array(this.forwardCb.buffer)}};f.prototype.decodeFrame=
function(){if(this._decoding)return!1;for(var b=this._decoding=!0;b;){var e=this.buffer.findNextMPEGStartCode();if(e==t.NOT_FOUND)b=!1,this.go("ended",null);else if(e==t.STALLING)this.buffer.rewind(32),b=!1;else{if(e==Ea)b=this.decodeSequenceHeader(!0),this._skipTillGop&&b&&(this._skipTillGop=!1);else if(this._skipTillGop)continue;else if(e==Fa)b=this.decodeGopHeader(!0);else if(e==Ga&&(b=this.decodePicture(!0)))return b;b||this.buffer.rewind(32)}}return this._decoding=!1};f.prototype.pictureRate=
30;f.prototype.decodeGopHeader=function(b){if(!b&&this._decoding||!this.buffer.has(Ha))return!1;this._gopHeaderDecoded=this._decoding=!0;this.buffer.advance(1);b=this.buffer.getBits(5);var e=this.buffer.getBits(6);this.buffer.advance(1);var g=this.buffer.getBits(6),l=this.buffer.getBits(6);this._currentTime=this._currentTimeSeqUpdate=1E3*(60*(60*b+e)+g+(l+1)/this.pictureRate);this._decoding=!1;return!0};f.prototype.decodeSequenceHeader=function(b){if(!b&&this._decoding||!this.buffer.has(sa))return!1;
this._decoding=!0;this._skipTillGop=!1;this.frameWidth=this.buffer.getBits(12);this.frameHeight=this.buffer.getBits(12);this.buffer.advance(4);this.pictureRate=d[this.buffer.getBits(4)];this.frameDuration=1E3/this.pictureRate;this.seqSent||(this.seqSent=!0,this.go("seq",{r:this.pictureRate,w:this.frameWidth,h:this.frameHeight}));this.rate=this.pictureRate*this._playbackRate;this._bitRate?b=19:(this._bitRate=this.buffer.getBits(18),this._bytesInForwardBufferLimit=this._bitRate*this.bufferSec>>3,this.buffer._bytesInBackwardBufferLimit=
this._bitRate*Ia>>3,b=1);this.buffer.advance(b);this.bufferSize=16384*this.buffer.getBits(10);this.buffer.advance(1);this.initBuffers();b=this.gl;if(this._lastCustomIntraMatrix=this.buffer.getBits(1)){for(var e=0;64>e;e++)this.customIntraQuantMatrix[k[e]]=this.buffer.getBits(8);this.intraQuantMatrix=this.customIntraQuantMatrix;this.QUANT_MATRIX.set(this.intraQuantMatrix);b.bindTexture(b.TEXTURE_2D,this.TextureDCTQuant);b.texImage2D(b.TEXTURE_2D,0,b.LUMINANCE,8,16,0,b.LUMINANCE,b.UNSIGNED_BYTE,this.QUANT_MATRIX)}if(this._lastCustomNonIntraMatrix=
this.buffer.getBits(1)){for(e=0;64>e;e++)this.customNonIntraQuantMatrix[k[e]]=this.buffer.getBits(8);this.nonIntraQuantMatrix=this.customNonIntraQuantMatrix;this.QUANT_MATRIX.set(this.nonIntraQuantMatrix,64);b.bindTexture(b.TEXTURE_2D,this.TextureDCTQuantInter);b.texImage2D(b.TEXTURE_2D,0,b.LUMINANCE,8,16,0,b.LUMINANCE,b.UNSIGNED_BYTE,this.QUANT_MATRIX)}this._decoding=!1;return!0};f.prototype.currentY=null;f.prototype.currentCr=null;f.prototype.currentCb=null;f.prototype.currentRGBA=null;f.prototype.pictureCodingType=
0;f.prototype.forwardY=null;f.prototype.forwardCr=null;f.prototype.forwardCb=null;f.prototype.fullPelForward=!1;f.prototype.forwardFCode=0;f.prototype.forwardRSize=0;f.prototype.forwardF=0;f.prototype.decodePicture=function(b){if(!b&&this._decoding||!this.buffer.has(this.bufferSize))return!1;this.mbn=0;this._decoding=!0;this.buffer.advance(10);pictureCodingTypePrevious=this.pictureCodingType;this.pictureCodingType=this.buffer.getBits(3);this.buffer.advance(16);if(0>=this.pictureCodingType||this.pictureCodingType>=
O)return this._decoding=!1;this.macroblockMV=new Int16Array(2*this.mbSize);if(this.pictureCodingType==V){this.macroblockMVUint8=new Uint8Array(this.macroblockMV.buffer);this.macroblockRepAdd=new Uint8Array(this.mbSize);this.fullPelForward=this.buffer.getBits(1);this.forwardFCode=this.buffer.getBits(3);if(0==this.forwardFCode)return this._decoding=!1;this.forwardRSize=this.forwardFCode-1;this.forwardF=1<<this.forwardRSize}this.pictureCodingType==Y||pictureCodingTypePrevious!=Y&&this.pictureCodingType!=
V||(this.currentYDCT16=new Int16Array(this.codedSize),this.currentYDCTU8=new Uint8Array(this.currentYDCT16.buffer),this.currentCrDCT16=new Int16Array(this.codedSize>>2),this.currentCrDCTU8=new Uint8Array(this.currentCrDCT16.buffer),this.currentCbDCT16=new Int16Array(this.codedSize>>2),this.currentCbDCTU8=new Uint8Array(this.currentCbDCT16.buffer));do b=this.buffer.findNextMPEGStartCode();while(b==Ja||b==Ka);for(;b>=La&&b<=Ma;)this.decodeSlice(b&255),b=this.buffer.findNextMPEGStartCode();this.buffer.rewind(32);
this.IDCT_GL();this.prev_pic_framebuffer=this.framebuffer;this._decoding=!1;b=0;this._currentTimeSeqUpdate&&(b=this._currentTimeSeqUpdate,this._currentTimeSeqUpdate=0);this.go("frame",{ybr:[this.prev_pic_framebuffer[0].texture,this.prev_pic_framebuffer[1].texture,this.prev_pic_framebuffer[2].texture],ts:b});return!0};f.prototype.quantizerScale=0;f.prototype.sliceBegin=!1;f.prototype.decodeSlice=function(b){this.sliceBegin=!0;this.macroblockAddress=(b-1)*this.mbWidth-1;this.motionFwV=this.motionFwVPrev=
this.motionFwH=this.motionFwHPrev=0;this.dcPredictorCb=this.dcPredictorCr=this.dcPredictorY=128;for(this.quantizerScale=this.buffer.getBits(5);this.buffer.getBits(1);)this.buffer.advance(8);do this.decodeMacroblock();while(!this.buffer.nextBytesAreStartCode())};f.prototype.macroblockAddress=0;f.prototype.mbRow=0;f.prototype.mbCol=0;f.prototype.macroblockType=0;f.prototype.macroblockIntra=!1;f.prototype.macroblockMotFw=!1;f.prototype.motionFwH=0;f.prototype.motionFwV=0;f.prototype.motionFwHPrev=0;
f.prototype.motionFwVPrev=0;f.prototype.decodeMacroblock=function(){for(var b=0,e=this.readCode(ca);34==e;)e=this.readCode(ca);for(;35==e;)b+=33,e=this.readCode(ca);b+=e;if(this.sliceBegin)this.sliceBegin=!1,this.macroblockAddress+=b;else{if(this.macroblockAddress+b>=this.mbSize)return;1<b&&(this.dcPredictorCb=this.dcPredictorCr=this.dcPredictorY=128,this.pictureCodingType==V&&(this.motionFwV=this.motionFwVPrev=this.motionFwH=this.motionFwHPrev=0));for(;1<b;)this.macroblockAddress++,this.mbRow=this.macroblockAddress/
this.mbWidth|0,this.mbCol=this.macroblockAddress%this.mbWidth,this.macroblockMV[2*(this.mbRow*this.mbWidth+this.mbCol)]=this.motionFwH,this.macroblockMV[2*(this.mbRow*this.mbWidth+this.mbCol)+1]=this.motionFwV,b--;this.macroblockAddress++}this.mbRow=this.macroblockAddress/this.mbWidth|0;this.mbCol=this.macroblockAddress%this.mbWidth;this.macroblockType=this.readCode(Na[this.pictureCodingType]);this.macroblockIntra=this.macroblockType&1;this.macroblockMotFw=this.macroblockType&8;0!=(this.macroblockType&
16)&&(this.quantizerScale=this.buffer.getBits(5));this.macroblockQuant[this.mbRow*this.mbWidth+this.mbCol]=this.quantizerScale;this.macroblockIsIntra[this.mbRow*this.mbWidth+this.mbCol]=this.macroblockIntra?255:0;this.macroblockIntra?this.motionFwV=this.motionFwVPrev=this.motionFwH=this.motionFwHPrev=0:(this.dcPredictorCb=this.dcPredictorCr=this.dcPredictorY=128,this.decodeMotionVectors(),this.macroblockMV[2*(this.mbRow*this.mbWidth+this.mbCol)]=this.motionFwH,this.macroblockMV[2*(this.mbRow*this.mbWidth+
this.mbCol)+1]=this.motionFwV);b=0!=(this.macroblockType&2)?this.readCode(ta):this.macroblockIntra?63:0;e=0;for(var g=32;6>e;e++)0!=(b&g)&&this.decodeBlockGL(e),g>>=1;this.mbn++};f.prototype.decodeMotionVectors=function(){if(this.macroblockMotFw){var b=this.readCode(ua);if(0!=b&&1!=this.forwardF){var e=this.buffer.getBits(this.forwardRSize);e=(Math.abs(b)-1<<this.forwardRSize)+e+1;0>b&&(e=-e)}else e=b;this.motionFwHPrev+=e;this.motionFwHPrev>(this.forwardF<<4)-1?this.motionFwHPrev-=this.forwardF<<
5:this.motionFwHPrev<-this.forwardF<<4&&(this.motionFwHPrev+=this.forwardF<<5);this.motionFwH=this.motionFwHPrev;this.fullPelForward&&(this.motionFwH<<=1);b=this.readCode(ua);0!=b&&1!=this.forwardF?(e=this.buffer.getBits(this.forwardRSize),e=(Math.abs(b)-1<<this.forwardRSize)+e+1,0>b&&(e=-e)):e=b;this.motionFwVPrev+=e;this.motionFwVPrev>(this.forwardF<<4)-1?this.motionFwVPrev-=this.forwardF<<5:this.motionFwVPrev<-this.forwardF<<4&&(this.motionFwVPrev+=this.forwardF<<5);this.motionFwV=this.motionFwVPrev;
this.fullPelForward&&(this.motionFwV<<=1)}else this.pictureCodingType==V&&(this.motionFwV=this.motionFwVPrev=this.motionFwH=this.motionFwHPrev=0)};f.prototype.copyMacroblock=function(b,e,g,l,q){var B=this.currentY32,M=this.currentCb32,S=this.currentCr32;var x=this.codedWidth;var T=x-16;var E=1==(e&1);var h=((this.mbRow<<4)+(e>>1))*x+(this.mbCol<<4)+(b>>1);var y=this.mbRow*x+this.mbCol<<2;var ea=y+(x<<2);if(1==(b&1))if(E)for(;y<ea;){var H=g[h]+g[h+x];h++;for(E=0;4>E;E++){var C=g[h]+g[h+x];h++;var N=
H+C+2>>2&255;H=g[h]+g[h+x];h++;N|=H+C+2<<6&65280;C=g[h]+g[h+x];h++;N|=H+C+2<<14&16711680;H=g[h]+g[h+x];h++;N|=H+C+2<<22&4278190080;B[y++]=N}y+=T>>2;h+=T-1}else for(;y<ea;){H=g[h++];for(E=0;4>E;E++)C=g[h++],N=H+C+1>>1&255,H=g[h++],N|=H+C+1<<7&65280,C=g[h++],N|=H+C+1<<15&16711680,H=g[h++],N|=H+C+1<<23&4278190080,B[y++]=N;y+=T>>2;h+=T-1}else if(E)for(;y<ea;){for(E=0;4>E;E++)N=g[h]+g[h+x]+1>>1&255,h++,N|=g[h]+g[h+x]+1<<7&65280,h++,N|=g[h]+g[h+x]+1<<15&16711680,h++,N|=g[h]+g[h+x]+1<<23&4278190080,h++,
B[y++]=N;y+=T>>2;h+=T}else for(;y<ea;){for(E=0;4>E;E++)N=g[h],h++,N|=g[h]<<8,h++,N|=g[h]<<16,h++,N|=g[h]<<24,h++,B[y++]=N;y+=T>>2;h+=T}x=this.halfWidth;T=x-8;E=1==(e/2&1);h=((this.mbRow<<3)+(e/2>>1))*x+(this.mbCol<<3)+(b/2>>1);y=this.mbRow*x+this.mbCol<<1;ea=y+(x<<1);if(1==(b/2&1))if(E)for(;y<ea;){b=l[h]+l[h+x];B=q[h]+q[h+x];h++;for(E=0;2>E;E++)e=l[h]+l[h+x],H=q[h]+q[h+x],h++,g=b+e+2>>2&255,C=B+H+2>>2&255,b=l[h]+l[h+x],B=q[h]+q[h+x],h++,g|=b+e+2<<6&65280,C|=B+H+2<<6&65280,e=l[h]+l[h+x],H=q[h]+q[h+
x],h++,g|=b+e+2<<14&16711680,C|=B+H+2<<14&16711680,b=l[h]+l[h+x],B=q[h]+q[h+x],h++,g|=b+e+2<<22&4278190080,C|=B+H+2<<22&4278190080,S[y]=g,M[y]=C,y++;y+=T>>2;h+=T-1}else for(;y<ea;){b=l[h];B=q[h];h++;for(E=0;2>E;E++)e=l[h],H=q[h++],g=b+e+1>>1&255,C=B+H+1>>1&255,b=l[h],B=q[h++],g|=b+e+1<<7&65280,C|=B+H+1<<7&65280,e=l[h],H=q[h++],g|=b+e+1<<15&16711680,C|=B+H+1<<15&16711680,b=l[h],B=q[h++],g|=b+e+1<<23&4278190080,C|=B+H+1<<23&4278190080,S[y]=g,M[y]=C,y++;y+=T>>2;h+=T-1}else if(E)for(;y<ea;){for(E=0;2>
E;E++)g=l[h]+l[h+x]+1>>1&255,C=q[h]+q[h+x]+1>>1&255,h++,g|=l[h]+l[h+x]+1<<7&65280,C|=q[h]+q[h+x]+1<<7&65280,h++,g|=l[h]+l[h+x]+1<<15&16711680,C|=q[h]+q[h+x]+1<<15&16711680,h++,g|=l[h]+l[h+x]+1<<23&4278190080,C|=q[h]+q[h+x]+1<<23&4278190080,h++,S[y]=g,M[y]=C,y++;y+=T>>2;h+=T}else for(;y<ea;){for(E=0;2>E;E++)g=l[h],C=q[h],h++,g|=l[h]<<8,C|=q[h]<<8,h++,g|=l[h]<<16,C|=q[h]<<16,h++,g|=l[h]<<24,C|=q[h]<<24,h++,S[y]=g,M[y]=C,y++;y+=T>>2;h+=T}};f.prototype.dcPredictorY;f.prototype.dcPredictorCr;f.prototype.dcPredictorCb;
f.prototype.blockData=null;f.prototype.print_data=function(b,e,g){for(g=0;g<e;g++)for(var l=0;l<b;l++);};f.prototype.dumpPixels2=function(b,e){var g=this.gl,l=new Uint8Array(b*e*4);g.readPixels(0,0,b,e,g.RGBA,g.UNSIGNED_BYTE,l);this.print_data(4*b,e,l)};f.prototype.GLfreeDecodedBuffers=function(){for(var b=0;b<this.rendered_frames_n;b++)this.glFrameBuffers.rendered[b][0].texture.inuse=0};f.prototype.setRenderBuffer=function(){for(var b=0;b<this.rendered_frames_n;b++){var e=this.glFrameBuffers.rendered[b];
if(!e[0].texture.inuse){e[0].texture.inuse=1;this.framebuffer=e;return}}throw Error("no free render buffers");};f.prototype.IDCT_GL=function(){this._dctData=[this.currentYDCTU8,this.currentCbDCTU8,this.currentCrDCTU8];this._prediction=[this.currentY,this.currentCb,this.currentCr];var b=this.gl,e=this.programs.idct_columns.uniforms;b.useProgram(this.programs.idct_columns.program);b.activeTexture(b.TEXTURE1);b.bindTexture(b.TEXTURE_2D,this.TextureDCTQuant);b.activeTexture(b.TEXTURE2);b.bindTexture(b.TEXTURE_2D,
this.TextureDCTQuantScale);b.texImage2D(b.TEXTURE_2D,0,b.LUMINANCE,this.mbWidth,this.mbHeight,0,b.LUMINANCE,b.UNSIGNED_BYTE,this.macroblockQuant);this.yuva||(b.activeTexture(b.TEXTURE3),b.bindTexture(b.TEXTURE_2D,this.TextureDCTPremultiple));b.activeTexture(b.TEXTURE4);b.bindTexture(b.TEXTURE_2D,this.TextureIntre);b.texImage2D(b.TEXTURE_2D,0,b.LUMINANCE,this.mbWidth,this.mbHeight,0,b.LUMINANCE,b.UNSIGNED_BYTE,this.macroblockIsIntra);for(var g=0;3>g;g++){var l=this.codedWidth,q=this.codedHeight;0!=
g&&(l>>=1,q>>=1);b.activeTexture(b.TEXTURE6);b.bindTexture(b.TEXTURE_2D,this.TextureLastNonZero);b.texImage2D(b.TEXTURE_2D,0,b.LUMINANCE,g?this.mbWidth:2*this.mbWidth,g?this.mbHeight:2*this.mbHeight,0,b.LUMINANCE,b.UNSIGNED_BYTE,this.last_non_zero[g]);b.activeTexture(b.TEXTURE0);b.bindTexture(b.TEXTURE_2D,this.TextureDCT);b.texImage2D(b.TEXTURE_2D,0,b.LUMINANCE_ALPHA,l,q,0,b.LUMINANCE_ALPHA,b.UNSIGNED_BYTE,this._dctData[g]);b.uniform1i(e.width,l);b.uniform1i(e.height,q);b.bindFramebuffer(b.FRAMEBUFFER,
this.glFrameBuffers.idct_1d[g].framebuffer);b.viewport(0,0,l/2,q);b.drawArrays(b.TRIANGLE_STRIP,0,4)}this.pictureCodingType==Y?(g=this.programs.idct_rows_intra.program,e=this.programs.idct_rows_intra.uniforms):(g=this.programs.idct_rows_inter.program,e=this.programs.idct_rows_inter.uniforms);b.useProgram(g);this.pictureCodingType==V&&(b.activeTexture(b.TEXTURE2),b.bindTexture(b.TEXTURE_2D,this.TextureIntre),b.texImage2D(b.TEXTURE_2D,0,b.LUMINANCE,this.mbWidth,this.mbHeight,0,b.LUMINANCE,b.UNSIGNED_BYTE,
this.macroblockRepAdd),b.activeTexture(b.TEXTURE3),b.bindTexture(b.TEXTURE_2D,this.TextureMV),b.texImage2D(b.TEXTURE_2D,0,b.RGBA,this.mbWidth,this.mbHeight,0,b.RGBA,b.UNSIGNED_BYTE,this.macroblockMVUint8));this.setRenderBuffer();for(g=0;3>g;g++)l=this.codedWidth,q=this.codedHeight,0!=g&&(l>>=1,q>>=1),b.activeTexture(b.TEXTURE0),b.bindTexture(b.TEXTURE_2D,this.glFrameBuffers.idct_1d[g].texture),this.pictureCodingType==V&&(b.uniform1f(e.mv_coef,0==g?1:.5),b.activeTexture(b.TEXTURE1),b.bindTexture(b.TEXTURE_2D,
this.prev_pic_framebuffer[g].texture)),b.uniform1i(e.width,l/2),b.uniform1i(e.height,q),b.bindFramebuffer(b.FRAMEBUFFER,this.framebuffer[g].framebuffer),b.viewport(0,0,l/4,q),b.drawArrays(b.TRIANGLE_STRIP,0,4)};f.prototype.decodeBlockGL=function(b){var e=0;this.fillArray(this.blockData,0);if(this.macroblockIntra){if(4>b){e=this.dcPredictorY;var g=this.readCode(Ba)}else e=4==b?this.dcPredictorCr:this.dcPredictorCb,g=this.readCode(P);if(0<g){var l=this.buffer.getBits(g);this.blockData[0]=0!=(l&1<<g-
1)?e+l:e+(-1<<g|l+1)}else this.blockData[0]=e;4>b?this.dcPredictorY=this.blockData[0]:4==b?this.dcPredictorCr=this.blockData[0]:this.dcPredictorCb=this.blockData[0];e=1}for(;;){g=this.readCode(Z);if(1==g&&0<e&&0==this.buffer.getBits(1))break;65535==g?(l=this.buffer.getBits(6),g=this.buffer.getBits(8),0==g?g=this.buffer.getBits(8):128==g?g=this.buffer.getBits(8)-256:128<g&&(g-=256)):(l=g>>8,g&=255,this.buffer.getBits(1)&&(g=-g));e+=l;l=k[e];e++;this.blockData[l]=g}if(4>b){g=0;var q=2*this.mbRow;var B=
2*this.mbCol;l=this.currentYDCT16;var M=this.codedWidth-8;var S=this.mbRow*this.codedWidth+this.mbCol<<4;0!=(b&1)&&(B++,S+=8);0!=(b&2)&&(q++,S+=this.codedWidth<<3);q=2*q*this.mbWidth+B}else g=4==b?1:2,q=this.mbRow*this.mbWidth+this.mbCol,l=4==b?this.currentCbDCT16:this.currentCrDCT16,M=(this.codedWidth>>1)-8,S=(this.mbRow*this.codedWidth<<2)+(this.mbCol<<3);this.last_non_zero[g][q]=e;this.copyBlockToDestination(this.blockData,l,S,M);this.pictureCodingType==V&&this.macroblockIntra&&(this.macroblockRepAdd[this.mbRow*
this.mbWidth+this.mbCol]=255)};f.prototype.clearBlock=function(b,e,g){for(var l=0;8>l;l++){for(var q=0;8>q;q++)b[e++]=0;e+=g}};f.prototype.copyBlockToDestination=function(b,e,g,l){for(var q=0,B=0;8>B;B++){for(var M=0;8>M;M++)e[g++]=b[q++];g+=l}};f.prototype.addBlockToDestination=function(b,e,g,l){for(var q=0,B=0;8>B;B++){for(var M=0;8>M;M++)e[g++]+=b[q++];g+=l}};f.prototype.readCode=function(b){var e=0;do e=b[e+this.buffer.getBits(1)];while(0<=e&&0!=b[e]);return b[e+2]};f.prototype.findStartCode=
function(b){for(var e;;)if(e=this.buffer.findNextMPEGStartCode(),e==b||e==t.NOT_FOUND||e==t.STALLING)return e};f.prototype.fillArray=function(b,e){for(var g=b.length;0<=--g;)b[g]=e};f.prototype.seek=function(b){if(this._decoding)return!1;this.GLfreeDecodedBuffers();var e=this._keyMap?this._getByteFromKeyMap(b):Math.round(this.buffer.bufferLengthTotal*b/this._meta.d);if(!0===this.buffer.seek(e)){do{if(this.findStartCode(Ea)==t.STALLING)return!1;this.decodeSequenceHeader();if(this.findStartCode(Fa)==
t.STALLING)return!1;this.decodeGopHeader()}while(b-this._currentTime>aa);this.go("seeked",[b,this._currentTime]);return!0}return!1};var c=function(){t.apply(this,arguments)};c.prototype=Object.create(t.prototype);c.prototype.constructor=c;c.prototype.moreThan4BytesLeft=function(){return this._live?!0:this._hls?this.currentBuffer.start!=this._hls[this._hls.length-1].start||32<=(this.currentBuffer.data.byteLength<<3)-this.indexInBuffer:this.index<this.NextMPEGStartCodeLimit};c.prototype.findNextMPEGStartCode=
function(){this.indexInBuffer=this.indexInBuffer+7>>3<<3;for(this.index=this.index+7>>3<<3;this.moreThan4BytesLeft();){if(this.nextBytesAreStartCode()){var b=(this.indexInBuffer>>3)+4-this.currentBuffer.data.byteLength-1;if(0<b){if(this.currentBuffer.nextItem&&this.currentBuffer.end+1==this.currentBuffer.nextItem.start)return this.previousBuffer=this.currentBuffer,this.currentBuffer=this.currentBuffer.nextItem,this.bufferLength=this.currentBuffer.data.byteLength,this.index=this.currentBuffer.start+
b<<3,this.indexInBuffer=b<<3,this._onBufferAdvance(),this.currentBuffer.data[b];this.onStalled(this.currentBuffer.end+1);return t.STALLING}this.indexInBuffer+=32;this.index+=32;return this.currentBuffer.data[this.indexInBuffer-8>>3]}this.advance(8)}this.index=this.bufferLengthTotal<<3;return t.NOT_FOUND};c.prototype.nextBytesAreStartCode=function(){if(this.index+7>>3>=this.bufferLengthTotal)return!0;var b=this.indexInBuffer+7>>3,e=this.bufferLength-b;if(2<e)return 0==this.currentBuffer.data[b]&&0==
this.currentBuffer.data[b+1]&&1==this.currentBuffer.data[b+2];if(this.currentBuffer.nextItem&&this.currentBuffer.end+1==this.currentBuffer.nextItem.start)switch(e){case 2:return 0==this.currentBuffer.data[b]&&0==this.currentBuffer.data[b+1]&&1==this.currentBuffer.nextItem.data[0];case 1:return 0==this.currentBuffer.data[b]&&0==this.currentBuffer.nextItem.data[0]&&1==this.currentBuffer.nextItem.data[1];default:return 0==this.currentBuffer.nextItem.data[0]&&0==this.currentBuffer.nextItem.data[1]&&1==
this.currentBuffer.nextItem.data[2]}else return this.onStalled(this.currentBuffer.end+1),t.STALLING};var d=[0,23.976,24,25,29.97,30,50,59.94,60,15,5,10,12,15,0,0],k=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),n=new Uint8Array([0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,
38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63]),z=new Uint8Array([8,16,19,22,26,27,29,34,16,16,22,24,27,29,34,37,19,22,26,27,29,34,34,38,22,22,26,27,29,34,37,40,22,26,27,29,32,35,40,48,26,27,29,32,35,40,48,58,26,27,29,34,38,46,56,69,27,29,35,38,46,56,69,83]),U=new Uint8Array([16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16]),R=new Uint8Array([32,
44,42,38,32,25,17,9,44,62,58,52,44,35,24,12,42,58,55,49,42,33,23,12,38,52,49,44,38,30,20,10,32,44,42,38,32,25,17,9,25,35,33,30,25,20,14,7,17,24,23,20,17,14,9,5,9,12,12,10,9,7,5,2]),ca=new Int16Array([3,6,0,9,12,0,0,0,1,15,18,0,21,24,0,27,30,0,33,36,0,0,0,3,0,0,2,39,42,0,45,48,0,0,0,5,0,0,4,51,54,0,57,60,0,0,0,7,0,0,6,63,66,0,69,72,0,75,78,0,81,84,0,-1,87,0,-1,90,0,93,96,0,99,102,0,105,108,0,111,114,0,0,0,9,0,0,8,117,120,0,123,126,0,129,132,0,135,138,0,0,0,15,0,0,14,0,0,13,0,0,12,0,0,11,0,0,10,141,
-1,0,-1,144,0,147,150,0,153,156,0,159,162,0,165,168,0,171,174,0,177,180,0,183,-1,0,-1,186,0,189,192,0,195,198,0,201,204,0,207,210,0,213,216,0,219,222,0,0,0,21,0,0,20,0,0,19,0,0,18,0,0,17,0,0,16,0,0,35,0,0,34,0,0,33,0,0,32,0,0,31,0,0,30,0,0,29,0,0,28,0,0,27,0,0,26,0,0,25,0,0,24,0,0,23,0,0,22]),fa=new Int8Array([3,6,0,-1,9,0,0,0,1,0,0,17]),L=new Int8Array([3,6,0,9,12,0,0,0,10,15,18,0,0,0,2,21,24,0,0,0,8,27,30,0,33,36,0,-1,39,0,0,0,18,0,0,26,0,0,1,0,0,17]),W=new Int8Array([3,6,0,9,15,0,12,18,0,24,21,
0,0,0,12,27,30,0,0,0,14,39,42,0,36,33,0,0,0,4,0,0,6,54,48,0,45,51,0,0,0,8,0,0,10,-1,57,0,0,0,1,60,63,0,0,0,30,0,0,17,0,0,22,0,0,26]),ta=new Int16Array([6,3,0,9,18,0,12,15,0,24,33,0,36,39,0,27,21,0,30,42,0,60,57,0,54,48,0,69,51,0,81,75,0,63,84,0,45,66,0,72,78,0,0,0,60,105,120,0,132,144,0,114,108,0,126,141,0,87,93,0,117,96,0,0,0,32,135,138,0,99,123,0,129,102,0,0,0,4,90,111,0,0,0,8,0,0,16,0,0,44,150,168,0,0,0,28,0,0,52,0,0,62,183,177,0,156,180,0,0,0,1,165,162,0,0,0,61,0,0,56,171,174,0,0,0,2,0,0,40,153,
186,0,0,0,48,192,189,0,147,159,0,0,0,20,0,0,12,240,249,0,0,0,63,231,225,0,195,219,0,252,198,0,0,0,24,0,0,36,0,0,3,207,261,0,243,237,0,204,213,0,210,234,0,201,228,0,216,222,0,258,255,0,264,246,0,-1,282,0,285,291,0,0,0,33,0,0,9,318,330,0,306,348,0,0,0,5,0,0,10,279,267,0,0,0,6,0,0,18,0,0,17,0,0,34,339,357,0,309,312,0,270,276,0,327,321,0,351,354,0,303,297,0,294,288,0,300,273,0,342,345,0,315,324,0,336,333,0,363,375,0,0,0,41,0,0,14,0,0,21,372,366,0,360,369,0,0,0,11,0,0,19,0,0,7,0,0,35,0,0,13,0,0,50,0,0,
49,0,0,58,0,0,37,0,0,25,0,0,45,0,0,57,0,0,26,0,0,29,0,0,38,0,0,53,0,0,23,0,0,43,0,0,46,0,0,42,0,0,22,0,0,54,0,0,51,0,0,15,0,0,30,0,0,39,0,0,47,0,0,55,0,0,27,0,0,59,0,0,31]),ua=new Int16Array([3,6,0,12,9,0,0,0,0,18,15,0,24,21,0,0,0,-1,0,0,1,27,30,0,36,33,0,0,0,2,0,0,-2,42,45,0,48,39,0,60,54,0,0,0,3,0,0,-3,51,57,0,-1,69,0,81,75,0,78,63,0,72,66,0,96,84,0,87,93,0,-1,99,0,108,105,0,0,0,-4,90,102,0,0,0,4,0,0,-7,0,0,5,111,123,0,0,0,-5,0,0,7,114,120,0,126,117,0,0,0,-6,0,0,6,153,162,0,150,147,0,135,138,0,
156,141,0,129,159,0,132,144,0,0,0,10,0,0,9,0,0,8,0,0,-8,171,198,0,0,0,-9,180,192,0,168,183,0,165,186,0,174,189,0,0,0,-10,177,195,0,0,0,12,0,0,16,0,0,13,0,0,14,0,0,11,0,0,15,0,0,-16,0,0,-12,0,0,-14,0,0,-15,0,0,-11,0,0,-13]),Ba=new Int8Array([6,3,0,18,15,0,9,12,0,0,0,1,0,0,2,27,24,0,21,30,0,0,0,0,36,33,0,0,0,4,0,0,3,39,42,0,0,0,5,0,0,6,48,45,0,51,-1,0,0,0,7,0,0,8]),P=new Int8Array([6,3,0,12,9,0,18,15,0,24,21,0,0,0,2,0,0,1,0,0,0,30,27,0,0,0,3,36,33,0,0,0,4,42,39,0,0,0,5,48,45,0,0,0,6,51,-1,0,0,0,7,0,
0,8]),Z=new Int32Array([3,6,0,12,9,0,0,0,1,21,24,0,18,15,0,39,27,0,33,30,0,42,36,0,0,0,257,60,66,0,54,63,0,48,57,0,0,0,513,51,45,0,0,0,2,0,0,3,81,75,0,87,93,0,72,78,0,96,90,0,0,0,1025,69,84,0,0,0,769,0,0,258,0,0,1793,0,0,65535,0,0,1537,111,108,0,0,0,1281,105,102,0,117,114,0,99,126,0,120,123,0,156,150,0,162,159,0,144,147,0,129,135,0,138,132,0,0,0,2049,0,0,4,0,0,514,0,0,2305,153,141,0,165,171,0,180,168,0,177,174,0,183,186,0,0,0,2561,0,0,3329,0,0,6,0,0,259,0,0,5,0,0,770,0,0,2817,0,0,3073,228,225,0,201,
210,0,219,213,0,234,222,0,216,231,0,207,192,0,204,189,0,198,195,0,243,261,0,273,240,0,246,237,0,249,258,0,279,276,0,252,255,0,270,282,0,264,267,0,0,0,515,0,0,260,0,0,7,0,0,1026,0,0,1282,0,0,4097,0,0,3841,0,0,3585,315,321,0,333,342,0,312,291,0,375,357,0,288,294,0,-1,369,0,285,303,0,318,363,0,297,306,0,339,309,0,336,348,0,330,300,0,372,345,0,351,366,0,327,354,0,360,324,0,381,408,0,417,420,0,390,378,0,435,438,0,384,387,0,0,0,2050,396,402,0,465,462,0,0,0,8,411,399,0,429,432,0,453,414,0,426,423,0,0,0,
10,0,0,9,0,0,11,0,0,5377,0,0,1538,0,0,771,0,0,5121,0,0,1794,0,0,4353,0,0,4609,0,0,4865,444,456,0,0,0,1027,459,450,0,0,0,261,393,405,0,0,0,516,447,441,0,516,519,0,486,474,0,510,483,0,504,498,0,471,537,0,507,501,0,522,513,0,534,531,0,468,477,0,492,495,0,549,546,0,525,528,0,0,0,263,0,0,2562,0,0,2306,0,0,5633,0,0,5889,0,0,6401,0,0,6145,0,0,1283,0,0,772,0,0,13,0,0,12,0,0,14,0,0,15,0,0,517,0,0,6657,0,0,262,540,543,0,480,489,0,588,597,0,0,0,27,609,555,0,606,603,0,0,0,19,0,0,22,591,621,0,0,0,18,573,576,0,
564,570,0,0,0,20,552,582,0,0,0,21,558,579,0,0,0,23,612,594,0,0,0,25,0,0,24,600,615,0,0,0,31,0,0,30,0,0,28,0,0,29,0,0,26,0,0,17,0,0,16,567,618,0,561,585,0,654,633,0,0,0,37,645,648,0,0,0,36,630,636,0,0,0,34,639,627,0,663,666,0,657,624,0,651,642,0,669,660,0,0,0,35,0,0,267,0,0,40,0,0,268,0,0,266,0,0,32,0,0,264,0,0,265,0,0,38,0,0,269,0,0,270,0,0,33,0,0,39,0,0,7937,0,0,6913,0,0,7681,0,0,4098,0,0,7425,0,0,7169,0,0,271,0,0,274,0,0,273,0,0,272,0,0,1539,0,0,2818,0,0,3586,0,0,3330,0,0,3074,0,0,3842]),aa=150,
Y=1,V=2,O=3,ra=452,sa=140,Ea=195,Ha=8,Fa=184,La=1,Ma=175,Ga=0,Ja=181,Ka=178,Na=[null,fa,L,W],ya,za,Aa})(m);var pa=!1,ma=!1;m.jsv_is_ww||(void 0!==m.jsv_config&&void 0!==m.jsv_config.doNotPatchCreateElement&&m.jsv_config.doNotPatchCreateElement||I(),w(ba));Q.ios=/(iPad|iPhone|iPod)/g.test(navigator.userAgent);m.video_jsv=function(){var a="muted volume loop preload data-audio poster src autoplay buffered seeking controls currentSrc currentTime defaultMuted defaultPlaybackRate playbackRate duration ended networkState paused readyState seekable played error".split(" "),
c="muted volume loop preload data-audio poster src autoplay controls currentSrc currentTime defaultMuted defaultPlaybackRate playbackRate duration".split(" ");if(m.jsv_is_ww)var d={};else{d=u.createElement("jsv");d.on=d.addEventListener;d.off=d.removeEventListener;d.style.display="block";d.style.background="black";var k=d.setAttribute;d.setAttribute=function(z){return-1!=c.indexOf(z)?(k.apply(this,arguments),f.prototype.__lookupSetter__(z).apply(this,arguments)):k.apply(this,arguments)}}for(var n in f.prototype)-1!=
a.indexOf(n)?-1!=c.indexOf(n)?Object.defineProperty(d,n,{configurable:!0,get:f.prototype.__lookupGetter__(n),set:f.prototype.__lookupSetter__(n)}):Object.defineProperty(d,n,{configurable:!0,get:f.prototype.__lookupGetter__(n)}):d[n]=f.prototype[n];for(n in f)d[n]=f[n];d._initOnce();return d};var f=m.jsv=function(){this._initOnce()};f.prototype._initOnce=function(){this.frontEnd=!m.jsv_is_ww;this.backEnd=m.jsv_is_ww||!m.jsv_is_ww&&!this.jsv_ww;this.frontEnd&&this._initOnceFront();this.backEnd&&this._initOnceBack();
this.reset(!0)};f.prototype._initOnceFront=function(){var a=this;m.jsv_is_ww||this.jsv_ww||(m.ez_vi=this.bind(this.onPageVisibilityChange,this));this._avSyncInt=this._canGoToLowerBitrate=!1;var c={unlockAudio:!0,syncInt:5E3,audioMap:!1,audioShiftSec:Oa,skipHard:!1,bufferSec:Pa,chunkSize:Qa,bufferMinSec:Ra};if(void 0!==m.jsv_config){for(var d in c)void 0===m.jsv_config[d]&&(m.jsv_config[d]=c[d]);c=m.jsv_config}for(var k in c)c.hasOwnProperty(k)&&(this[k]=c[k]);this.audioEl=u.createElement("audio");
this.audioEl.preload=this._preload;this.ial=this.inu=/(iPad|iPhone|iPod|Android)/g.test(navigator.userAgent);if(!m.jsv_is_ww&&this.unlockAudio)if(this.ial){var n=function(){m.ez_unlock.off("unlocked",n);a.unlockaudio()};m.ez_unlock.on("unlocked",n)}else this.unlockAudioContext();if(this.jsv_ww)for(k in c)c.hasOwnProperty(k)&&this.jsv_ww.postMessage({t:"eq",n:k,args:[c[k]]});if(this.bufferMinSec>=this.bufferSec)return this._onError("bufferMinSec must be smaller bufferSec",K._MEDIA_ERR_ABORTED);this.reInitCanvas();
this.initWebGL()?this.setSharedVar("this","igl",!0):(this.setSharedVar("this","igl",!1),this.canvasContext=this.canvasEl.getContext("2d"));this.addEventListener("play",function(){a._poster&&"none"!=a._poster.style.display&&(a._poster.style.display="none")})};f.prototype._initOnceBack=function(){m.jsv_is_ww&&m.ez_dis(this);m.ez_http&&(this._loader=m.ez_http())};f.prototype.reset=function(a){this.frontEnd&&(this.audioNeedsPlaying&&(this.audioEl.destroy?this.audioEl.destroy():this.audioEl.load&&(this.audioEl.src=
"",this.audioEl.load())),this.audioType="file",this.bitrateFromSource=0,this._currentSrcs=NaN,this.setSharedVar("this","sr",""),this.audioSrc="",this.audioNeedsPlaying=!1,this.setSharedVar("this","iv",!1),this.mutedAudio=this.pendingAudioSrc=!1);this.backEnd&&(this._currentSrcMedia=NaN);this._playbackRate=this._defaultPlaybackRate=this._volume=1;this._muted=this._defaultMuted=!1;this._preload="auto";this._loop=this._autoplay=this._poster=!1;this._onSrcChangeAndInit();this.jsv_ww&&!a&&this.jsv_ww.postMessage({t:"func",
n:"reset",args:[]})};f.prototype._onSrcChangeAndInit=function(){var a=this;this._imagedata=[];this.startRange=NaN;this._playbackRate=this._defaultPlaybackRate;this.frontEnd&&(this.stopRendering(!0),this.firstFrameDecoded=this.firstFrameRendered=!1,this._waitingTimes=0,this._autoplayed=this._loadeddataed=!1,this._decodedFrames=[],this._audioRTS=this._lateCounter=this.lastAudioTimeIsTheSame=0,this.setSharedVar("this","ws",!1),this._firstPlayInit=this._firstPlay=!0,this._played=[],this._playedFrom=0,
this._bsplaying=this._wasplaying=this._playing=this._rendering=this._canplay=!1,this.du=NaN,this._stallingVideo=this._afterStalledVideo=this._stallingAudio=!1,this._seekingTo=NaN,this._seeking=!1,this._readyState=D,this.ns>p&&this._emit("abort"),this.setSharedVar("this","ns",p));if(this.backEnd){this._seekingBackend=!1;this.WebSocket&&(this.WebSocket.close(),this.WebSocket=!1);m.clearInterval(this._livePollInterval);this._loadingRange={start:-2,end:"",_currentSrcMedia:""};this._hlsVideoListSize=0;
this._gopHeaderDecoded=!1;this._hls=[];this._loading&&(this._loader.cancel(this._requestId),this._emit("suspend"));this._loading=!1;this._requestId=NaN;this._bytesLoaded=0;this._contentLength=NaN;this.decoder=new m.jsv_dec;this.decoder._initGL(this.gl);var c=this.bind(this.onm,this);this.decoder.on("meta",function(fa){c(fa.detail)});var d=this.bind(this.onf,this);this.decoder.on("frame",function(fa){d(fa.detail)});var k=this.bind(this.onendedDecoder,this);this.decoder.on("ended",function(fa){k(fa.detail)});
var n=this.bind(this.ons,this);this.decoder.on("seq",function W(L){a.decoder.off("seq",W);n(L.detail)});var z=this.bind(this.callFEF,this);this.decoder.on("seeked",function(L){a._seekingBackend=!1;z("ovs",[L.detail[0],L.detail[1]])});this._skipTillGopLast=0;this.decoder._skipTillGop=!0;this.buffer=this.decoder.buffer;var U=this.bind(this.onNodata,this);this.buffer.on("stalled",function(L){U(L.detail)});var R=this.bind(this.ld,this);this.buffer.on("bufferadvance",function(){a._loading||R(void 0,!0)});
var ca=this.bind(this._onBufferRemoved,this);this.buffer.on("bufferremoved",function(L){ca(L.detail)})}this._error=null;this._live=-1;this._ended=this._isHLS=!1;this.frameHeight=this.frameWidth=0;this._meta=!1;this._currentTime=0};f.prototype._onSrcChange=function(){this._onSrcChangeAndInit();var a=this.sr.split(/[#?]/)[0].split(".").pop().trim();if("jsv"==a)this._live=!1,this._currentSrcMedia=this.sr;else if("m3u8"==a)this._isHLS=!0,this._currentSrcMedia=NaN;else if(0==this.sr.indexOf("ws://")||
0==this.sr.indexOf("wss://"))this._live=!0,this.setSharedVar("this","ws",!0);else return this._onError("Unsupported src",K._MEDIA_ERR_SRC_NOT_SUPPORTED);if(this.backEnd){if(this.ws){if(!m.WebSocket)return this._onError("WebSockets are not supported",K._MEDIA_ERR_NETWORK);this.buffer._freeMemory=!0;this.buffer._ws=!0}this.buffer._live=this._live;this._isHLS?this._getHLSList():this.ws||("auto"==this._preload?this.callBEF("ld",[0]):"metadata"==this._preload&&this.loadAjax(0,this.chunkSize,!1))}this.frontEnd&&
(this._emit("srcchange"),this.ws?this.autoplay&&this.play():this._emit("loadstart"))};f.prototype.callFEF=function(a,c){this.frontEnd?this[a].apply(this,c):m.postMessage({t:"func",n:a,args:c})};f.prototype.callBEF=function(a,c){this.backEnd?this[a].apply(this,c):this.jsv_ww.postMessage({t:"func",n:a,args:c})};f.prototype.onendedDecoder=function(){this.setSharedVar("this","de",!0)};f.prototype._onEnded=function(){this._readyState=xa;this.stopRendering(!0);this._ended=!0;this.audioNeedsPlaying&&this.audioEl.pause();
this._emit("pause");this._emit("ended");this.loop&&this.play()};f.prototype.imd=function(a){this._imagedata.push(a)};f.prototype.wm=function(a){Q.worker_cap=a;this.igl||Q.worker_cap.sid||(this.sendImageDataW=!0)};f.prototype._updateRate=function(){this.rate=this.pictureRate*this._playbackRate;this.frameDuraionNominal=1E3/this.pictureRate;this.frameDuration=1E3/this.rate};f.prototype.ons=function(a){this.backEnd&&this._live&&(a.d=NaN,this.onm(a));this.pictureRate=a.r;this._updateRate();m.jsv_is_ww&&
m.postMessage({t:"func",n:"ons",args:[a]})};f.prototype.onm=function(a){this.setSharedVar("this","du",a.d);this.frameWidth=a.w;this.frameHeight=a.h;this.mbWidth=this.frameWidth+15>>4;this.mbHeight=this.frameHeight+15>>4;this.codedWidth=this.mbWidth<<4;this.codedHeight=this.mbHeight<<4;this.halfWidth=this.mbWidth<<3;this.halfHeight=this.mbHeight<<3;if(m.jsv_is_ww)m.postMessage({t:"func",n:"onm",args:[a]});else{this.canvasEl.width=this.frameWidth;this.canvasEl.height=this.frameHeight;if(this.igl)if(Q.ios)this.reInitCanvas(this.frameWidth,
this.frameHeight),this.initWebGL();else{this.canvasEl.style.width="99.99%";var c=this;setTimeout(function(){c.canvasEl.style.width="100%"},30)}this._readyState=X;this._emit("durationchange");this._emit("resize");this._emit("loadedmetadata");this._canplay=!0}};f.prototype.canPlayType=function(a){return-1!=a.indexOf("jsv")?"probably":""};f.prototype.__defineGetter__("videoWidth",function(){return this.frameWidth});f.prototype.__defineGetter__("videoHeight",function(){return this.frameHeight});f.prototype.__defineGetter__("error",
function(){return this._error});f.prototype.__defineGetter__("readyState",function(){return this._readyState});f.prototype.__defineGetter__("paused",function(){return!this._playing});f.prototype.__defineGetter__("networkState",function(){return this.ns});f.prototype.__defineGetter__("ended",function(){return this._ended});f.prototype.__defineGetter__("preload",function(){return this._preload});f.prototype.__defineSetter__("preload",function(a){1<arguments.length&&(a=arguments[1]);this._preload=this.audioEl.preload=
a});f.prototype.__defineGetter__("defaultPlaybackRate",function(){return this._defaultPlaybackRate});f.prototype._normClamp=function(a,c,d){a=parseFloat(a);if(a<c||a>d)a=1;return a};f.prototype.__defineSetter__("defaultPlaybackRate",function(a){1<arguments.length&&(a=arguments[1]);this._defaultPlaybackRate=this._normClamp(a,0,100)});f.prototype.__defineGetter__("playbackRate",function(){return this._playbackRate});f.prototype.__defineSetter__("playbackRate",function(a){1<arguments.length&&(a=arguments[1]);
this._playbackRate=this._normClamp(a,0,100);this._updateRate();this.audioEl&&(this.audioEl.playbackRate=this._playbackRate);this._emit("ratechange")});f.prototype.__defineGetter__("defaultMuted",function(){return this._defaultMuted});f.prototype.__defineSetter__("defaultMuted",function(a){1<arguments.length&&(a=arguments[1]);this._defaultMuted=a});f.prototype.__defineGetter__("muted",function(){return this._muted});f.prototype.__defineSetter__("muted",function(a){1<arguments.length&&(a=arguments[1]);
a&&(a=!0);var c=this._muted;this._muted=a;this.audioEl.muted=this._muted;if(Q.ios||this.inu){if(this._muted||!this.mutedAudio||this.ial)this._muted&&this.audioNeedsPlaying&&(this.mutedAudio=!0,this.audioNeedsPlaying=!1,this.audioEl.pause());else if(this.mutedAudio=!1,this.audioNeedsPlaying=!0,this.ws)this.audioEl.connect(),this._playing&&this.audioEl.play();else{this._playing&&this.stopRendering(!1);var d=this;v(this.audioEl,this._currentTime/1E3-this._audioRTS,function(){d._playing&&d.startRendering()})}!a&&
c&&this.setSharedVar("this","inu",!1)}c!=a&&(a||this.removeAttribute("muted"),this._emit("volumechange"))});f.prototype.__defineGetter__("volume",function(){return this._volume});f.prototype.__defineSetter__("volume",function(a){1<arguments.length&&(a=arguments[1]);this._volume=this._normClamp(a,0,1);this.audioEl.volume=this._volume;this._emit("volumechange")});f.prototype.__defineGetter__("data-audio",function(){return this.audioSrc});f.prototype.__defineSetter__("data-audio",function(a){1<arguments.length&&
(a=arguments[1]);this.pendingAudioSrc=!1;this.audioSrc=a;if(-1!=a.indexOf("ws://")||-1!=a.indexOf("wss://")){if(!m.AudioContext&&!m.webkitAudioContext)return this._onError("AudioContext is not supported",K._MEDIA_ERR_SRC_NOT_SUPPORTED),!1;this.audioType="ws";this.setSharedVar("this","ws",!0);this.audioEl=void 0===m.jsv_au_de?new jsv_audio_sockets({url:a,channels:2,bufferMinSec:this.bufferMinSec+this.audioShiftSec,skipHard:this.skipHard,ms:Sa}):m.jsv_au_de(a)}else-1!=a.indexOf(".m3u8")?(this.audioType=
"hls",this.pendingAudioSrc=a,this.audioEl.src="",this.audioEl.load()):"."!=a.split("?")[0].substr(-4,1)?(this.audioType="livehttp",this.audioEl.src=a):(this.audioType="file",this.audioEl.src=a,this.audioEl.load());this.audioNeedsPlaying=""!=a?!0:!1;(Q.ios||this.inu)&&this._muted&&this.audioNeedsPlaying&&(this.mutedAudio=!0,this.audioNeedsPlaying=!1,this.audioEl.pause())});f.prototype.__defineGetter__("poster",function(){return this._poster?this._poster.src:""});f.prototype.__defineSetter__("poster",
function(a){1<arguments.length&&(a=arguments[1]);this._poster||(this.style.position="relative",this._poster=u.createElement("img"),this._poster.setAttribute("style","z-index:2;position:absolute;top:0px;left:0px;bottom:0px;right:0px;width:100%;height:100%;"),this.appendChild(this._poster));""!=a?this._poster.src=a:this._poster.style.display="none"});f.prototype.__defineGetter__("played",function(){this._addPlayedRange();if(!this._playedTiRa){this._playedTiRa={};var a=this;this._playedTiRa.__defineGetter__("length",
function(){return a._played.length});this._playedTiRa.start=function(c){return a._played[c].start};this._playedTiRa.end=function(c){return a._played[c].end}}return this._playedTiRa});f.prototype.__defineGetter__("seekable",function(){var a=this;return{length:1,start:function(c){return 0},end:function(c){return a.du}}});f.prototype.__defineGetter__("buffered",function(){return this.getByteRanges()});f.prototype.__defineGetter__("seeking",function(){return this._seeking});f.prototype.__defineGetter__("controls",
function(){return!1});f.prototype.__defineSetter__("controls",function(a){return!1});f.prototype.__defineGetter__("duration",function(){return this.du});f.prototype.__defineSetter__("duration",function(a){return!1});f.prototype.__defineGetter__("src",function(){return this.sr});f.prototype._setAudioMap=function(a){this["data-audio"]=String.prototype.replace.apply(a,this.audioMap)};f.prototype._setMultiSource=function(a){if("string"!==typeof a){this._currentSrcs=a;for(var c=this.bitrateFromSource=
0;c<this._currentSrcs.length;c++){var d=parseInt(this._currentSrcs[c].b);if(this._currentSrcs[c].use){this.bitrateFromSource=d;a=this._currentSrcs[c].src;break}this.bitrateFromSource<d&&(this.bitrateFromSource=d,a=this._currentSrcs[c].src)}}else this._currentSrcs=NaN;return a};f.prototype.__defineSetter__("src",function(a){1<arguments.length&&(a=arguments[1]);a=this._setMultiSource(a);a.indexOf("http")&&a.indexOf("ws")&&(a=(new wa(a,u.baseURI)).href);this.ss(a)});f.prototype.__defineGetter__("currentSrc",
function(){return this.sr});f.prototype.__defineSetter__("currentSrc",function(a){throw Error("Setting currentSrc is not allowed !");});f.prototype.__defineGetter__("currentTime",function(){return this._currentTime/1E3});f.prototype.ss=function(a){this.frontEnd&&(this.audioMap&&this._setAudioMap(a),this._checkLowerBitrateExists(),this.setSharedVar("this","iv",!0),this.setSharedVar("this","sr",a));this._onSrcChange();this.jsv_ww&&this.jsv_ww.postMessage({t:"func",n:"ss",args:[a]})};f.prototype._checkLowerBitrateExists=
function(){this._canGoToLowerBitrate=!1;for(var a=0;a<this._currentSrcs.length;a++)this.bitrateFromSource>this._currentSrcs[a].b&&(!this._canGoToLowerBitrate||this._canGoToLowerBitrate.b<this._currentSrcs[a].b)&&(this._canGoToLowerBitrate=this._currentSrcs[a])};f.prototype._goToLowerRate=function(){this._emit("bitratechange",{b:this._canGoToLowerBitrate.b,src:this._canGoToLowerBitrate.src});this.bitrateFromSource=this._canGoToLowerBitrate.b;var a=this._currentTime/1E3,c=this;this.on("loadedmetadata",
function k(){c.off("loadedmetadata",k);c.on("seeked",function z(){c.off("seeked",z);c.play()});c.currentTime=a});this.ss(this._canGoToLowerBitrate.src)};f.prototype._addPlayedRange=function(){var a=this._played,c=this._currentTime/1E3;if(this._playedFrom!=c){for(var d=!1,k=!1,n=0;n<a.length;n++)if(a[n].end>=this._playedFrom){for(d=Math.min(this._playedFrom,a[n].start);a.length-1>=n;)if(a[n].start<=c)k=Math.max(c,a[n].end),a.splice(n,1);else break;a.splice(n,0,{start:d,end:k});break}!1===d&&a.push({start:this._playedFrom,
end:c})}return a};f.prototype._emit=function(a,c,d){void 0===c&&(c=null);if(m.jsv_is_ww)this.dispatchEvent(a,c),void 0==d&&m.postMessage({t:"event",n:a,args:c});else{"error"==a&&(this.error=this._error=c);var k=u.createEvent("CustomEvent");k.initCustomEvent(a,!1,!1,c);this.dispatchEvent(k);this.jsv_ww&&void 0==d&&this.jsv_ww.postMessage({t:"event",n:a,args:c})}};f.prototype.ovs=function(a,c){this._currentTime=c;this.audioNeedsPlaying?v(this.audioEl,this._currentTime/1E3-this._audioRTS,this.bind(this._onAfterAVSynced,
this)):this._onAfterAVSynced()};f.prototype._onAfterAVSynced=function(){this._playedFrom=this._currentTime/1E3;this._seeking=!1;this._seekingTo=NaN;this.decodeFrame();var a=u.createEvent("CustomEvent");a.initCustomEvent("timeupdate",!1,!1,null);this.dispatchEvent(a);this._emit("seeked");if(this._playing||this._bsplaying)this._playing=this._wasplaying=!0,this._readyState>=ia&&this.startRendering()};f.prototype.__defineSetter__("currentTime",function(a){if(this._seeking||this._live)return!1;if(!this.du)return this._toNoFramesState("v",
"s"),!0;if(a>this.du)return this._onError("Time out of range",K._MEDIA_ERR_DECODE);if(this.audioNeedsPlaying&&this.ial)if(this._muted)this.mutedAudio=this.audioSrc,this.audioNeedsPlaying=!1;else return!1;this.audioNeedsPlaying&&(this.audioEl.pause(),this.audioEl.currentTime=a);this._bsplaying=this._playing;this.stopRendering(!0);this._decodedFrames=[];this._addPlayedRange();this._stallingAudio=this._stallingVideo=this._ended=!1;this._seeking=!0;this._seekingTo=a;this._readyState=X;this._emit("seeking");
this.setSharedVar("this","de",!1);this.callBEF("sct",[a])});f.prototype.sct=function(a){this._seekingBackend=this._seekingInProcess=!0;this._seekingTo=a;this.decoder.seek(a);this._seekingInProcess=!1};f.prototype.__defineGetter__("loop",function(){return this._loop});f.prototype.__defineSetter__("loop",function(a){this._loop=a});f.prototype.__defineGetter__("autoplay",function(){return this._autoplay});f.prototype.__defineSetter__("autoplay",function(a){this._autoplay=a});f.prototype._onAudioStalled=
function(){if(!this._stallingAudio){this._toNoFramesState("a");var a=this;v(this.audioEl,this._currentTime/1E3-this._audioRTS,function(){a._fromStalledState("a")})}};var ha=!0;f.prototype.unlockAudioContext=function(){if(!ha)return!0;ha=!1;var a=m.AudioContext||m.webkitAudioContext;if(a){a=new a;var c=a.createBuffer(1,1,22050),d=a.createBufferSource();d.buffer=c;d.connect(a.destination);d["function"==typeof d.noteOn?"noteOn":"start"](0);m.jsv_AC=a}};f.prototype.unlockaudio=function(){this.audioEl.play();
this.audioEl.pause();this.unlockAudioContext();this.ial=!1;this._emit("audiounlocked")};f.prototype._fromStalledState=function(a){this._emit("unstalled");"v"==a?(this._stallingVideo=!1,this._stallingAudio||(this._playing=this._wasplaying)):(this._stallingAudio=!1,this._stallingVideo||(this._playing=this._wasplaying)&&this._readyState>=ia&&this.startRendering())};f.prototype._toNoFramesState=function(a,c){this._stallingVideo||this._stallingAudio||(this._wasplaying=this._playing,this.stopRendering(!0),
this._readyState>X&&(this._readyState=X),"v"==a&&"w"==c?(this._emit("waiting"),this._waitingTimes++,this._waitingTimes>na&&this._canGoToLowerBitrate&&this._goToLowerRate()):this._emit("stalled"));"v"==a?this._stallingVideo||(this._stallingVideo=this._afterStalledVideo=!0,this.ws||this.audioEl.pause(),this.ws&&(this._wsChunksInBuffer=0)):this._stallingAudio=!0};f.prototype.log=function(){va.log.apply(va,arguments)};f.prototype.nd=function(){this._waitingForData=!0;this._decodedFrames.length||this._toNoFramesState("v",
"s")};f.prototype.onNodata=function(a){this.callFEF("nd",null);this.ws||this.callBEF("ld",[a])};f.prototype.bind=function(a,c){return function(){return a.apply(c,arguments)}};f.prototype._onBufferRemoved=function(a){this._bytesLoaded-=a.data.byteLength;if(this._isHLS&&(this._getHLSFileByStart(a.start).loaded=!1,this._live))for(;this._hls[0].start<=a.start;)this._hls.splice(0,1)};f.prototype.destroy=function(){this.reset();delete this.audioEl;this.parentNode.removeChild(this);this.jsv_ww&&this.jsv_ww.terminate()};
f.prototype._onError=function(a,c){K.message=a;K.code=c;this._error=K;this._emit("error",this._error);return!1};f.prototype.onPageVisibilityChange=function(a){"hidden"==a&&this._playing&&this.audioNeedsPlaying?(this.pause(),this.pausedBackground=!0):"visible"==a&&this.pausedBackground&&(this.pausedBackground=!1,this.play())};f.prototype.loadAjax=function(a,c,d){void 0===d&&(d=!0);if(this._isHLS)k=a,n=c,a=0,c="";else{void 0===a&&(a=0,c="");if(!this._loader.stream){if(a%this.chunkSize){if(this._loading&&
this._loadingRange.start==a&&this._currentSrcMedia==this._loadingRange._currentSrcMedia)return!1;a=Math.floor(a/this.chunkSize)*this.chunkSize}""!=c&&(c=Math.ceil(c/this.chunkSize)*this.chunkSize-1)}var k=a,n=c}if(this._loading&&this._loadingRange.start==k&&this._currentSrcMedia==this._loadingRange._currentSrcMedia)return!1;this._loading&&(this._loader.cancel(this._requestId),this._emit("suspend"));this.setSharedVar("this","ns",J);this._loading=!0;this._loadingRange={start:k,end:n,_currentSrcMedia:this._currentSrcMedia};
var z=this,U=this._currentSrcMedia;this._requestId=this._loader.load({bpc:this.chunkSize,mode:this._isHLS?"whole":"range",bType:"arraybuffer",start:a,end:c,url:this._currentSrcMedia,onError:function(R){z._onError(R.detail.message,K._MEDIA_ERR_NETWORK)},ondata:function(R){if(R.id!=z._requestId)return!1;""==z._loadingRange.end&&(z._loadingRange.end=R.total-1);R.url=U;z.onchunk(R)},done:function(R){if(R.id!=z._requestId)return!1;z.setSharedVar("this","ns",r);z._loading=!1;d&&z.ld(z._loadingRange.end+
1)}})};f.prototype.ld=function(a,c,d){if(0!==a%1&&void 0!==a)throw Error("not int");if(this.ws)return!1;void 0===d&&(d=!0);if(void 0!==c&&this._loading)return!1;this._isHLS?(void 0===a&&(a=this._loadingRange.end+1),a=this.getNextRangeToDownloadHLS(a)):a=this.buffer.getNextRangeToDownload(a,this.chunkSize,this._bytesInForwardBufferLimit,this._seekingBackend);a&&this.loadAjax(a.start,a.end,d)};f.prototype.getByteRanges=function(){if(!this.TiRa){this.TiRa={};var a=this;this.TiRa.__defineGetter__("length",
function(){var c=0;if(a.startRange){c++;for(var d=a.startRange;d.nextItem;)d=d.nextItem,c++}return c});this.TiRa.start=function(c){for(var d=0,k=a.startRange;;){if(d==c)return k.startDuration;k=k.nextItem;d++}};this.TiRa.end=function(c){for(var d=0,k=a.startRange;;){if(d==c)return k.endDuration;k=k.nextItem;d++}}}return this.TiRa};f.prototype.ab=function(a){this.firstFrameDecoded&&!this._waitingForData||this._seeking?this._waitingForData=!1:(this._waitingForData=!1,this.decodeFrame());a.nextItem=
null;if(this.startRange)if(a.start<this.startRange.start)a.end+1==this.startRange.start?(this.startRange.start=a.start,this.startRange.startDuration=a.startDuration):(a.nextItem=this.startRange,this.startRange=a);else{for(var c=this.startRange;c.nextItem&&c.nextItem.end<a.start;)c=c.nextItem;var d=c.nextItem;c.end+1==a.start?(c.end=a.end,c.endDuration=a.endDuration,a=c):c.nextItem=a;d&&a.end+1==d.start?(a.end=d.end,a.endDuration=d.endDuration,a.nextItem=d.nextItem):a.nextItem=d}else this.startRange=
a;this._emit("suspend");this._emit("progress")};f.prototype.onchunk=function(a){var c=a.data.byteLength;this._loadingRange.start+=c;this._bytesLoaded+=c;this._isHLS?(c=this._getHLSFileByUrl(a.url),c.loaded=!0,a.start=c.start,a.end=c.end,a.startDuration=c.startDuration,a.endDuration=c.endDuration):(this._contentLength=a.total,this._contentLength>Ta&&(this.buffer._freeMemory=!0),a.startDuration=this.du*a.start/a.total,a.endDuration=this.du*a.end/a.total);a.data=new Uint8Array(a.data);this.buffer.addBuffer(a);
!this._meta&&this.decoder._initMeta()&&(this._meta=!0,this.buffer.startRange.startDuration=a.startDuration=this.du*a.start/a.total,this.buffer.startRange.endDuration=a.endDuration=this.du*a.end/a.total);this.callFEF("ab",[{start:a.start,end:a.end,startDuration:a.startDuration,endDuration:a.endDuration}]);this._contentLength==this._bytesLoaded&&(this.buffer._fullyLoaded=!0,this._emit("loaded"));this._seekingBackend&&!this._seekingInProcess&&this.sct(this._seekingTo)};f.prototype.setSharedVar=function(a,
c,d){"this"==a?(this[c]=d,a="eq"):(Q[c]=d,a="jsv_gl");this.jsv_ww?this.jsv_ww.postMessage({t:a,n:c,args:[d]}):m.jsv_is_ww&&m.postMessage({t:a,n:c,args:[d]})};f.prototype.load=function(){this._emit("abort");this._emit("emptied");this.callBEF("ld",null)};f.prototype["in"]=function(){this.targetTime=Date.now()+this.frameDuration;this._firstPlayInit=!0;this.play()};f.prototype._onFirstPlay=function(){var a=this;this._firstPlay=!1;if(this._live&&this._isHLS&&!this.audioNeedsPlaying&&(this._firstPlayInit=
!1,!this._hls.length))this.on("vls",function d(){a.off("vls",d);a.callBEF("ld",[a._hls[a._hls.length-a._hlsVideoListSize].start]);a._firstPlayInit=!0;a.play()});this.pendingAudioSrc&&(this.audioEl.src=this.pendingAudioSrc,this.pendingAudioSrc=!1);this.audioNeedsPlaying&&("ws"!=this.audioType?(this._firstPlayInit=!1,v(this.audioEl,this._currentTime/1E3-this._audioRTS,function(){a._live&&"hls"==a.audioType?a._getLiveMeta():(a._firstPlayInit=!0,a.play())})):this.audioEl.connect());this.ws&&this.iv&&
(this._firstPlayInit=!1,this.callBEF("sws",null))};f.prototype.play=function(){var a=this;if(this._error)return!1;if(!this._playing){this._wasplaying=!0;if(this.audioNeedsPlaying&&this.ial)if(this._muted)this.mutedAudio=this.audioSrc,this.audioNeedsPlaying=!1;else return!1;if(this._stallingVideo||this._stallingAudio||this._seeking)return!1;this._firstPlay&&this._onFirstPlay();if(this._firstPlayInit){this._playing=!0;this.audioNeedsPlaying&&"livehttp"==this.audioType&&this.audioEl.load();if(this._ended)return this._ended=
!1,this.currentTime=0,!0;setTimeout(function(){a._emit("play")},50);this._readyState>=ia&&setTimeout(this.bind(this.startRendering,this),51)}}};f.prototype.pause=function(){this._wasplaying=!1;if(!this._playing)return!1;var a=this;this.stopRendering(!0);this.audioNeedsPlaying&&this.audioEl.pause();setTimeout(function(){a._emit("pause")},1)};f.prototype.decodeFrame=function(){this.sendImageDataW&&this.jsv_ww.postMessage({t:"func",n:"imd",args:[this.canvasContext.createImageData(this.frameWidth,this.frameHeight)]});
this.callBEF("df",null)};f.prototype.df=function(){this.decoder.decodeFrame()};f.prototype.checkAVSync=function(){var a=this._currentTime-(this.frameDuration-(Date.now()-this.lastRenderTime))-1E3*(this.audioEl.currentTime+this._audioRTS)+100;if(a<-da){this.audioEl.pause();var c=this;m.clearTimeout(this.timeATimeout);this.timeATimeout=setTimeout(function(){c._playing&&c.audioEl.play()},a)}else if(a>da){if(!this._live&&this.audioEl.readyState<ia)if(this.audioEl.paused)this.audioEl.play();else return this._onAudioStalled();
this.stopRendering(!1);this.targetTime+=a;this.lastRenderTime=Date.now()+a;c=this;m.clearTimeout(this.timeVTimeout);this.timeVTimeout=setTimeout(this.bind(this.startRendering,this),a)}else this.targetTime=0>a?this.targetTime-Math.min(this.frameDuration/2,-a):this.targetTime+a};f.prototype.stopRendering=function(a){this._rendering=!1;m.clearInterval(this._avSyncInt);m.clearTimeout(this.displayFrameToken);a&&(this._playing=!1)};f.prototype.startRendering=function(){if(this._rendering)return!1;this._rendering=
!0;this._emit("playing");this.audioNeedsPlaying&&(this.audioEl.play(),this.ws||(this._avSyncInt=setInterval(this.bind(this.checkAVSync,this),ja)));m.clearTimeout(this.displayFrameToken);this._afterStalledVideo&&this.ws||(this.targetTime=Date.now());this._afterStalledVideo=!1;this.displayFrame()};f.prototype.displayOneFrame=function(){Date.now();this.targetTime+=this.frameDuration;var a=this._decodedFrames.shift();if(!a)return this.de?this._onEnded():this._toNoFramesState("v",this._waitingForData?
"s":"w");if(this.igl){var c=this.bind(this.renderFrameGL,this);requestAnimationFrame(function(){c(a)})}else requestAnimationFrame(this.bind(this.renderFrame2D,this));this._currentTime=a.ts?a.ts:this._currentTime+this.frameDuraionNominal;this.lastRenderTime=Date.now();var d=u.createEvent("CustomEvent");d.initCustomEvent("timeupdate",!1,!1,null);this.dispatchEvent(d);this.decodeFrame()};f.prototype.displayFrame=function(){var a=Date.now()-this.targetTime;a=Math.max(0,this.frameDuration-a);this.displayFrameToken=
setTimeout(this.bind(this.displayFrame,this),a);this.targetTime+=this.frameDuration;var c=this._decodedFrames.shift();if(!c)return this.de?this._onEnded():this._toNoFramesState("v",this._waitingForData?"s":"w");if(this.igl){var d=this.bind(this.renderFrameGL,this);requestAnimationFrame(function(){d(c)})}else requestAnimationFrame(this.bind(this.renderFrame2D,this));this._currentTime=c.ts?c.ts:this._currentTime+this.frameDuraionNominal;this.lastRenderTime=Date.now();a=u.createEvent("CustomEvent");
a.initCustomEvent("timeupdate",!1,!1,null);this.dispatchEvent(a);this.decodeFrame()};f.prototype.reInitCanvas=function(a,c){var d=u.createElement("canvas");this.canvasEl&&(this.canvasEl.parentNode.removeChild(this.canvasEl),d.width=a,d.height=c);d.style.width="100%";d.style.height="100%";d.style.objectFit="contain";d.style.display="block";this.canvasEl=d;this.appendChild(this.canvasEl);this._emit("canvas")};f.prototype.onf=function(a){if(m.jsv_is_ww||!m.jsv_is_ww&&!this.jsv_ww)if(this.igl)m.jsv_is_ww?
m.postMessage({t:"func",n:"onf",args:[a]}):this._decodedFrames.push(a);else{var c=this.YCbCrToRGBA(a.ybr[0],a.ybr[1],a.ybr[2]);m.jsv_is_ww?m.postMessage({t:"func",n:"onf",args:[{rgba:c,ts:a.ts}]}):this._decodedFrames.push({rgba:c,ts:a.ts})}else{if(!this.frameWidth)return!1;this.igl?this._decodedFrames.push({ybr:[new Uint8Array(a.ybr[0]),new Uint8Array(a.ybr[1]),new Uint8Array(a.ybr[2])],ts:a.ts}):this._decodedFrames.push({rgba:a.rgba,ts:a.ts})}if(!m.jsv_is_ww){this.firstFrameDecoded=!0;if(!this.firstFrameRendered)if(this.firstFrameRendered=
!0,a=this._decodedFrames.shift(),this.igl){var d=this.bind(this.renderFrameGL,this);requestAnimationFrame(function(){d(a)})}else requestAnimationFrame(this.bind(this.renderFrame2D,this));c=this._readyState;this._decodedFrames.length<Ua?(this._seeking||this.decodeFrame(),this._decodedFrames.length&&(this._readyState=ia,this._stallingVideo&&this._fromStalledState("v"),c<ia&&(this._emit("canplay"),this._playing&&!this._rendering&&this.startRendering()))):(this._readyState=Ca,c<Ca&&this._emit("canplaythrough"),
this._autoplay&&!this._autoplayed&&(this._autoplayed=!0,this.play()))}};f.prototype.renderFrame2D=function(){this.canvasContext.putImageData(this.decodedFrame.rgba,0,0)};f.prototype.YCbCrToRGBA=function(a,c,d){var k=m.jsv_is_ww?Q.worker_cap.sid?new ImageData(this.frameWidth,this.frameHeight):this._imagedata.shift():this.canvasContext.createImageData(this.frameWidth,this.frameHeight),n=k.data;this.decoder.fillArray(n,255);for(var z=0,U=this.codedWidth,R=this.codedWidth+(this.codedWidth-this.frameWidth),
ca=0,fa=this.halfWidth-(this.frameWidth>>1),L=0,W=4*this.frameWidth,ta=4*this.frameWidth,ua=this.frameWidth>>1,Ba=this.frameHeight>>1,P,Z,aa,Y,V,O,ra=0;ra<Ba;ra++){for(var sa=0;sa<ua;sa++)Z=c[ca],aa=d[ca],ca++,P=a[z++],aa-=128,Z-=128,O=P-16,P=1.59603*aa,Y=-.81297*aa-.39176*Z,V=2.01723*Z,n[L]=P+1.16438*O,n[L+1]=Y+1.16438*O,n[L+2]=V+1.16438*O,L+=4,P=a[z++],O=P-16,P=1.59603*aa,Y=-.81297*aa-.39176*Z,V=2.01723*Z,n[L]=P+1.16438*O,n[L+1]=Y+1.16438*O,n[L+2]=V+1.16438*O,L+=4,P=a[U++],O=P-16,P=1.59603*aa,Y=
-.81297*aa-.39176*Z,V=2.01723*Z,n[W]=P+1.16438*O,n[W+1]=Y+1.16438*O,n[W+2]=V+1.16438*O,W+=4,P=a[U++],O=P-16,P=1.59603*aa,Y=-.81297*aa-.39176*Z,V=2.01723*Z,n[W]=P+1.16438*O,n[W+1]=Y+1.16438*O,n[W+2]=V+1.16438*O,W+=4;z+=R;U+=R;L+=ta;W+=ta;ca+=fa}return k};f.prototype.renderFrameGL=function(a){var c=this.gl,d=a.ybr[0],k=a.ybr[1];a=a.ybr[2];c.bindFramebuffer(c.FRAMEBUFFER,null);c.useProgram(this.programRGBA);c.uniform1f(this.uniforms_width,this.codedWidth);0=="length"in d?(c.activeTexture(c.TEXTURE0),
c.bindTexture(c.TEXTURE_2D,d),c.activeTexture(c.TEXTURE1),c.bindTexture(c.TEXTURE_2D,k),c.activeTexture(c.TEXTURE2),c.bindTexture(c.TEXTURE_2D,a),c.viewport(0,this.frameHeight-this.codedHeight,this.codedWidth,this.codedHeight),d.inuse=!1):(c.activeTexture(c.TEXTURE0),c.bindTexture(c.TEXTURE_2D,this._T),c.texImage2D(c.TEXTURE_2D,0,c.RGBA,this.codedWidth/4,this.frameHeight,0,c.RGBA,c.UNSIGNED_BYTE,d),c.activeTexture(c.TEXTURE1),c.bindTexture(c.TEXTURE_2D,this._L),c.texImage2D(c.TEXTURE_2D,0,c.RGBA,
this.halfWidth/4,this.frameHeight/2,0,c.RGBA,c.UNSIGNED_BYTE,k),c.activeTexture(c.TEXTURE2),c.bindTexture(c.TEXTURE_2D,this._N),c.texImage2D(c.TEXTURE_2D,0,c.RGBA,this.halfWidth/4,this.frameHeight/2,0,c.RGBA,c.UNSIGNED_BYTE,a),c.viewport(0,0,this.codedWidth,this.frameHeight));c.drawArrays(c.TRIANGLE_STRIP,0,4)};f.prototype.gl=null;f.prototype.programRGBA=null;f.prototype._T=null;f.prototype._L=null;f.prototype._N=null;f.prototype.createTexture=function(a,c,d){var k=this.gl,n=k.createTexture();k.bindTexture(k.TEXTURE_2D,
n);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MAG_FILTER,k.NEAREST);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MIN_FILTER,k.NEAREST);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_S,k.CLAMP_TO_EDGE);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_T,k.CLAMP_TO_EDGE);c&&k.uniform1i(k.getUniformLocation(d,c),a);return n};f.prototype.compileShader=function(a,c){var d=this.gl,k=d.createShader(a);d.shaderSource(k,c);d.compileShader(k);if(!d.getShaderParameter(k,d.COMPILE_STATUS))throw Error(d.getShaderInfoLog(k));return k};
f.prototype.initWebGL=function(){var a={preserveDrawingBuffer:!0};try{var c=this.gl=this.canvasEl.getContext("webgl",a)||this.canvasEl.getContext("experimental-webgl",a)}catch(d){return!1}if(!c)return!1;a=c.createBuffer();c.bindBuffer(c.ARRAY_BUFFER,a);c.bufferData(c.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,1,1]),c.STATIC_DRAW);this.programRGBA=c.createProgram();c.attachShader(this.programRGBA,this.compileShader(c.VERTEX_SHADER,qa));c.attachShader(this.programRGBA,this.compileShader(c.FRAGMENT_SHADER,
Va));c.linkProgram(this.programRGBA);if(!c.getProgramParameter(this.programRGBA,c.LINK_STATUS))throw Error(c.getProgramInfoLog(this.programRGBA));c.useProgram(this.programRGBA);this.uniforms_width=c.getUniformLocation(this.programRGBA,"_ae");this._T=this.createTexture(0,"_T",this.programRGBA);this._L=this.createTexture(1,"_L",this.programRGBA);this._N=this.createTexture(2,"_N",this.programRGBA);a=c.getAttribLocation(this.programRGBA,"vertex");c.enableVertexAttribArray(a);c.vertexAttribPointer(a,2,
c.FLOAT,!1,0,0);return!0};var K={};K.MEDIA_ERR_ABORTED=K._MEDIA_ERR_ABORTED=1;K.MEDIA_ERR_NETWORK=K._MEDIA_ERR_NETWORK=2;K.MEDIA_ERR_DECODE=K._MEDIA_ERR_DECODE=3;K.MEDIA_ERR_SRC_NOT_SUPPORTED=K._MEDIA_ERR_SRC_NOT_SUPPORTED=4;K.code=0;K.message="";var na=5,ja=1E3,da=300,p=0,r=1,J=2,D=0,X=1,xa=2,ia=3,Ca=4,Ua=10,Sa=.45,Oa=0,Ra=1,Pa=30,Ia=30,Qa=3E5,Ta=5E7,Va="precision mediump float;\nuniform float _ae;\nuniform sampler2D _T;\nuniform sampler2D _L;\nuniform sampler2D _N;\nvarying vec2 _S;\nmat4 _ak = mat4(\n1.16438,  0.00000,  1.59603, -0.87079,\n1.16438, -0.39176, -0.81297,  0.52959,\n1.16438,  2.01723,  0.00000, -1.08139,\n0, 0, 0, 1\n);\nvoid main() {\nfloat _aA, _au, _av;\nfloat _af = floor( mod( _ae * _S.x, 8. ) );\nif( _af == 0.0 )\n{\n_aA = texture2D(_T, _S).r;\n_au = texture2D(_N, _S).r;\n_av = texture2D(_L, _S).r;\n}\nelse if( _af == 1. )\n{\n_aA = texture2D(_T, _S).g;\n_au = texture2D(_N, _S).r;\n_av = texture2D(_L, _S).r;\n}\nelse if( _af == 2. )\n{\n_aA = texture2D(_T, _S).b;\n_au = texture2D(_N, _S).g;\n_av = texture2D(_L, _S).g;\n}\nelse if( _af == 3. )\n{\n_aA = texture2D(_T, _S).a;\n_au = texture2D(_N, _S).g;\n_av = texture2D(_L, _S).g;\n}\nelse if( _af == 4. )\n{\n_aA = texture2D(_T, _S).r;\n_au = texture2D(_N, _S).b;\n_av = texture2D(_L, _S).b;\n}\nelse if( _af == 5. )\n{\n_aA = texture2D(_T, _S).g;\n_au = texture2D(_N, _S).b;\n_av = texture2D(_L, _S).b;\n}\nelse if( _af == 6. )\n{\n_aA = texture2D(_T, _S).b;\n_au = texture2D(_N, _S).a;\n_av = texture2D(_L, _S).a;\n}\nelse\n{\n_aA = texture2D(_T, _S).a;\n_au = texture2D(_N, _S).a;\n_av = texture2D(_L, _S).a;\n}\ngl_FragColor = vec4(_aA, _av, _au, 1.) * _ak;\n}",
qa="attribute vec2 vertex;\nvarying vec2 _S;\nvoid main() {\n_S = vertex;\ngl_Position = vec4((vertex * 2.0 - 1.0) * vec2(1, -1), 0.0, 1.0);\n}";f.NETWORK_EMPTY=p;f.NETWORK_IDLE=r;f.NETWORK_LOADING=J;f.NETWORK_NO_SOURCE=3;f.HAVE_NOTHING=D;f.HAVE_METADATA=X;f.HAVE_CURRENT_DATA=xa;f.HAVE_FUTURE_DATA=ia;f.HAVE_ENOUGH_DATA=Ca;m.jsv_helper=function(){};m.jsv_helper.iPhoneVersion=function(){if(!/(iPhone)/g.test(navigator.userAgent))return NaN;var a=m.screen.height;switch(a){case 480:return"4";case 568:return"5";
case 667:return"6";case 736:return"6";default:return 736<a?"6":"4"}};m.jsv_helper.iOsVersion=function(){if(!/(iPhone)/g.test(navigator.userAgent))return NaN;var a=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);return parseInt(a[1],10)};if(m.jsv_is_ww){var ka=new m.video_jsv;m.addEventListener("message",function(a){var c=a.data;a=c.args&&!Array.isArray(c.args)&&"event"!=c.t?Object.keys(c.args).map(function(d){return c.args[d]}):c.args;switch(c.t){case "event":ka._emit(c.n,a,!0);break;case "set":ka.__lookupSetter__(c.n).apply(ka,
a);break;case "func":ka[c.n].apply(ka,a);break;case "eq":ka[c.n]=a[0];break;case "jsv_gl":Q[c.n]=a[0]}})}})(A)})();